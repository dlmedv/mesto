(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,r(o.key),o)}}function n(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(t){var n=function(t,n){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===e(n)?n:String(n)}var o=function(){function e(t,r,o,i,u,c){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n(this,"_getTemplate",(function(){return document.querySelector(a._templateSelector).content.querySelector(".element").cloneNode(!0)})),n(this,"_setEventListeners",(function(){a._buttonLikeCard=a._element.querySelector(".element__icon"),a._element.querySelector(".element__icon-trash").addEventListener("click",(function(){a._handleConfirmClick(a._cardId,a._element)})),a._buttonLikeCard.addEventListener("click",(function(){a._handleCardLike(a._cardId,a)})),a._element.querySelector(".element__photo").addEventListener("click",(function(){a._getCardPopupImg()}))})),n(this,"_getCardPopupImg",(function(){a._handleCardClick(a._name,a._link)})),n(this,"generateCard",(function(){return a._element=a._getTemplate(),a._setEventListeners(),a._elementPhoto=a._element.querySelector(".element__photo"),a._elementPhoto.src=a._link,a._elementPhoto.alt=a._name,a._element.querySelector(".element__title").textContent=a._name,a._buttonDeleteCard=a._element.querySelector(".element__icon-trash"),a._buttonLikeCard=a._element.querySelector(".element__icon"),a._counterLikes=a._element.querySelector(".element__numbers"),a._counterLikes.textContent=a._likes.length,a._userId!==a._ownerId&&a._buttonDeleteCard.remove(),a._likes.find((function(e){return e._id===a._userId}))&&(a._buttonLikeCard.classList.add("element__icon_active"),a._isLike=!0),a._element})),this._name=t.name,this._link=t.link,this._templateSelector=r,this._userId=c,this._ownerId=t.owner._id,this._cardId=t._id,this._handleCardClick=o,this._handleConfirmClick=i,this._handleCardLike=u,this._isLike=!1,this._likes=t.likes}var r,o;return r=e,(o=[{key:"_clickLikeButton",value:function(){this._buttonLikeCard.classList.toggle("element__icon_active")}},{key:"isLike",get:function(){return this._isLike}},{key:"getLikes",value:function(e){this._likes=e,this._counterLikes.textContent=this._likes.length}},{key:"toggleLike",value:function(){this._buttonLikeCard.classList.toggle("element__icon_active")}},{key:"toggleIsLike",value:function(){this._isLike=!this._isLike}},{key:"delete",value:function(){this._element.remove(),this._element=null}}])&&t(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),e}();function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===i(o)?o:String(o)),r)}var o}var c=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._config=t,this._formElement=n,this._inputList=Array.from(n.querySelectorAll(t.inputSelector)),this._buttonElement=n.querySelector(t.submitButtonSelector)}var t,n;return t=e,(n=[{key:"_hideInputError",value:function(e){var t=this._formElement.querySelector(".".concat(e.id,"-input-error"));t.classList.remove(this._config.errorClass),t.textContent="",e.classList.remove(this._config.inputErrorClass)}},{key:"_showInputError",value:function(e){var t=this._formElement.querySelector(".".concat(e.id,"-input-error"));t.classList.add(this._config.errorClass),t.textContent=e.validationMessage,e.classList.add(this._config.inputErrorClass)}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(e){return!e.validity.valid}))}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._config.inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._config.inactiveButtonClass),this._buttonElement.disabled=!1)}},{key:"_setEventListeners",value:function(){var e=this;this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._setEventListeners(),this._formElement.addEventListener("submit",(function(e){e.preventDefault()}))}},{key:"setButtonState",value:function(){this._toggleButtonState()}},{key:"clearInputError",value:function(){var e=this;this._inputList.forEach((function(t){e._checkInputValidity(t)}))}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),a={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==l(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===l(o)?o:String(o)),r)}var o}var f=function(){function e(t,n){var r=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._container=document.querySelector(n),this._renderer=r}var t,n;return t=e,(n=[{key:"renderItems",value:function(e){var t=this;e.reverse().forEach((function(e){t._renderer(e)}))}},{key:"addItem",value:function(e){this._container.prepend(e)}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==p(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===p(o)?o:String(o)),r)}var o}var _=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popup=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}var t,n;return t=e,(n=[{key:"open",value:function(){this._popup.classList.add("popup_active"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.remove("popup_active"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"setEventListeners",value:function(){var e=this;this._popup.addEventListener("mousedown",(function(t){(t.target.classList.contains("popup_active")||t.target.classList.contains("popup__close"))&&e.close()}))}}])&&y(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==h(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==h(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===h(o)?o:String(o)),r)}var o}function m(){return m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=v(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},m.apply(this,arguments)}function v(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=S(e)););return e}function b(e,t){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},b(e,t)}function g(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}var k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=S(r);if(o){var n=S(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return g(this,e)});function u(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,e))._formSubmit=t,n._form=n._popup.querySelector(".popup__form"),n._inputs=n._form.querySelectorAll(".popup__input"),n._button=n._popup.querySelector(".popup__button"),n}return t=u,(n=[{key:"changeText",value:function(e){this._button.textContent=e}},{key:"_getInputValues",value:function(){var e=this;return this._inputsValues={},this._inputs.forEach((function(t){e._inputsValues[t.name]=t.value})),this._inputsValues}},{key:"setEventListeners",value:function(){var e=this;m(S(u.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(t){t.preventDefault(),e._formSubmit(e._getInputValues())}))}},{key:"close",value:function(){m(S(u.prototype),"close",this).call(this),this._form.reset()}}])&&d(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(_);function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==w(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===w(o)?o:String(o)),r)}var o}function L(){return L="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=P(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},L.apply(this,arguments)}function P(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=C(e)););return e}function O(e,t){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},O(e,t)}function j(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function C(e){return C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},C(e)}var I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=C(r);if(o){var n=C(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return j(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this,e))._popupImage=t._popup.querySelector(".popup__image"),t._popupTitle=t._popup.querySelector(".popup__title-img"),t}return t=u,(n=[{key:"open",value:function(e,t){this._popupImage.src=e,this._popupImage.alt=t,this._popupTitle.textContent=t,L(C(u.prototype),"open",this).call(this)}}])&&E(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(_);function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,x(r.key),r)}}function R(e,t,n){return(t=x(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e){var t=function(e,t){if("object"!==T(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==T(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===T(t)?t:String(t)}var B=function(){function e(t){var n=this,r=t.name,o=t.about,i=t.avatar,u=t._userId;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),R(this,"getUserInfo",(function(){return{name:n._name.textContent,about:n._about.textContent,avatar:n._avatar.src}})),R(this,"setUserInfo",(function(e){var t=e.name,r=e.about,o=e.avatar;n._name.textContent=t,n._about.textContent=r,n._avatar.src=o,n._avatar.alt=t})),this._name=r,this._about=o,this._avatar=i,this._userId=u}var t,n;return t=e,(n=[{key:"getUserId",value:function(){return this._userId}}])&&q(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function U(e){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U(e)}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==U(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==U(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===U(o)?o:String(o)),r)}var o}function V(){return V="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=A(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},V.apply(this,arguments)}function A(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=M(e)););return e}function N(e,t){return N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},N(e,t)}function J(e,t){if(t&&("object"===U(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return H(e)}function H(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M(e){return M=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},M(e)}var z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=M(r);if(o){var n=M(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return J(this,e)});function u(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,e))._handleConfirmClick=t.bind(H(n)),n._button=n._popup.querySelector(".popup__button"),n._form=n._popup.querySelector(".popup__form"),n}return t=u,(n=[{key:"changeText",value:function(e){this._button.textContent=e}},{key:"open",value:function(e,t){V(M(u.prototype),"open",this).call(this),this._cardId=e,this._cardItem=t}},{key:"setEventListeners",value:function(){var e=this;V(M(u.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(t){t.preventDefault(),e._handleConfirmClick(e._cardId,e._cardItem,e._button),e._cardItem.remove()}))}}])&&D(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(_),F=(document.querySelector(".popup_photo"),document.querySelector(".popup__image"),document.querySelector(".popup__title-img"),document.querySelector(".profile__edit")),G=(document.querySelector(".popup_edit-card").querySelector(".popup__button"),document.querySelector(".popup__form")),K=document.querySelector(".popup__add-form"),Q=(document.querySelector(".popup__input_type_title"),document.querySelector(".popup__input_type_link"),document.querySelector(".popup__input_type_name")),W=document.querySelector(".popup__input_type_about"),X=document.querySelector(".profile__title"),Y=document.querySelector(".profile__subtitle"),Z=(document.querySelector(".elements"),document.querySelector(".profile__add")),$=(document.querySelector(".popup_add-card"),document.querySelectorAll(".popup__close"),document.querySelector(".profile__icon-edit")),ee=document.querySelector(".popup__avatar-form"),te=(document.querySelector(".popup__input_type_avatar"),{name:X,about:Y,avatar});function ne(e){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ne(e)}function re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==ne(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ne(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===ne(o)?o:String(o)),r)}var o}var oe,ie=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._url=t.url,this._headers=t.headers}var t,n;return t=e,n=[{key:"_checkStatusRes",value:function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}},{key:"getInitialCards",value:function(){var e=this;return fetch("".concat(this._url,"/cards"),{headers:this._headers}).then((function(t){return e._checkStatusRes(t)}))}},{key:"getUserInfo",value:function(){var e=this;return fetch("".concat(this._url,"/users/me"),{headers:this._headers}).then((function(t){return e._checkStatusRes(t)}))}},{key:"setInfoUser",value:function(e){var t=this,n=e.name,r=e.about;return fetch("".concat(this._url,"/users/me"),{headers:this._headers,method:"PATCH",body:JSON.stringify({name:n,about:r})}).then((function(e){return t._checkStatusRes(e)}))}},{key:"createNewCard",value:function(e){var t=this;return fetch("".concat(this._url,"/cards"),{headers:this._headers,method:"POST",body:JSON.stringify({name:e.name,link:e.link})}).then((function(e){return t._checkStatusRes(e)}))}},{key:"deleteCard",value:function(e){var t=this;return fetch("".concat(this._url,"/cards/").concat(e),{headers:this._headers,method:"DELETE"}).then((function(e){return t._checkStatusRes(e)}))}},{key:"setLikes",value:function(e){var t=this;return fetch("".concat(this._url,"/cards/").concat(e,"/likes"),{headers:this._headers,method:"PUT"}).then((function(e){return t._checkStatusRes(e)}))}},{key:"deleteLikes",value:function(e){var t=this;return fetch("".concat(this._url,"/cards/").concat(e,"/likes"),{headers:this._headers,method:"DELETE"}).then((function(e){return t._checkStatusRes(e)}))}},{key:"setUserAvatar",value:function(e){var t=this;return fetch("".concat(this._url,"/users/me/avatar"),{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})}).then((function(e){return t._checkStatusRes(e)}))}}],n&&re(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),ue=new ie({url:"https://mesto.nomoreparties.co/v1/cohort-60",headers:{authorization:"e24dd49a-4101-455b-9fb5-311038dfd707","Content-Type":"application/json"}});Promise.all([ue.getInitialCards(),ue.getUserInfo()]).then((function(e){var t=e[0],n=e[1];le.renderItems(t),se.setUserInfo(n),se.getUserId(n._id),oe=n._id})).catch((function(e){console.log(e)}));var ce=function(e){var t=new o(e,"#element-template",(function(){_e.open(e.link,e.name)}),ae,(function(e){t.isLike?ue.deleteLikes(e).then((function(e){t.getLikes(e.likes),t.toggleIsLike(),t.toggleLike()})).catch((function(e){console.log(e)})):ue.setLikes(e).then((function(e){t.getLikes(e.likes),t.toggleIsLike(),t.toggleLike()})).catch((function(e){console.log(e)}))}),oe);return t.generateCard()};function ae(e,t){ye.open(e,t)}var le=new f({renderer:function(e){var t=ce(e);le.addItem(t)}},".elements"),se=new B(te),fe=new k(".popup_edit-card",(function(e){fe.changeText("Сохранение..."),ue.setInfoUser(e).then((function(e){se.setUserInfo(e)})).catch((function(e){console.log(e)})).finally((function(){fe.changeText("Сохранить"),fe.close()}))})),pe=new k(".popup_add-card",(function(e){pe.changeText("Сохранение..."),ue.createNewCard(e).then((function(e){var t=ce(e);le.addItem(t)})).catch((function(e){console.log(e)})).finally((function(){pe.changeText("Сохранить"),pe.close()}))})),ye=new z(".popup_delete-card",(function(e,t){ye.changeText("Удаление..."),ue.deleteCard(e).then((function(){})).then((function(){t.delete()})).then((function(){ye.close()})).catch((function(e){console.log(e)})).finally((function(){ye.changeText("Да"),ye.close()}))})),_e=new I(".popup_photo"),he=new k(".popup_avatar",(function(e){he.changeText("Сохранение..."),ue.setUserAvatar(e.link).then((function(e){se.setUserInfo(e)})).then((function(){he.close()})).catch((function(e){console.log(e)})).finally((function(){he.changeText("Сохранить"),he.close()}))}));F.addEventListener("click",(function(e){e.preventDefault();var t=se.getUserInfo(),n=t.name,r=t.about;Q.value=n,W.value=r,fe.open(),me.clearInputError()})),Z.addEventListener("click",(function(){pe.open(),de.setButtonState()})),$.addEventListener("click",(function(){he.open(),ve.setButtonState()})),fe.setEventListeners(),pe.setEventListeners(),_e.setEventListeners(),ye.setEventListeners(),he.setEventListeners();var de=new c(a,K),me=new c(a,G),ve=new c(a,ee);de.enableValidation(),me.enableValidation(),ve.enableValidation()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNDTyxNQUFLLFdBQ0YyQyxHQUFnQjdGLE9BQ3BCLElBQ0NvRSxPQUFNLFNBQUNDLEdBQ0pDLFFBQVFDLElBQUlGLEVBQ2hCLElBQ0NtQixTQUFRLFdBQ0xLLEdBQWdCUCxXQUFXLGFBQzNCTyxHQUFnQjdGLE9BQ3BCLEdBQ1IsSUFJSjRCLEVBQXVCL0csaUJBQWlCLFNBQ3BDLFNBQUNpRixHQUNHQSxFQUFJbEIsaUJBQ0osTUFBd0JxRixHQUFTSixjQUF6QnBILEVBQUksRUFBSkEsS0FBTTBFLEVBQUssRUFBTEEsTUFDZFksRUFBVW5CLE1BQVFuRSxFQUNsQnVGLEVBQVdwQixNQUFRTyxFQUNuQmtFLEdBQWdCVixPQUNoQm9CLEdBQWNDLGlCQUNsQixJQUVKL0QsRUFBV3BILGlCQUFpQixTQUN4QixXQUNJNEssR0FBYWQsT0FDYnNCLEdBQWFDLGdCQUNqQixJQUVKaEUsRUFBa0JySCxpQkFBaUIsU0FDL0IsV0FDSWdMLEdBQWdCbEIsT0FDaEJ3QixHQUFnQkQsZ0JBQ3BCLElBR0piLEdBQWdCZSxvQkFDaEJYLEdBQWFXLG9CQUNiMUIsR0FBVzBCLG9CQUNYakIsR0FBdUJpQixvQkFDdkJQLEdBQWdCTyxvQkFHaEIsSUFBTUgsR0FBZSxJQUFJbkosRUFBYytCLEVBQWtCaUQsR0FDbkRpRSxHQUFnQixJQUFJakosRUFBYytCLEVBQWtCZ0QsR0FDcERzRSxHQUFrQixJQUFJckosRUFBYytCLEVBQWtCc0QsSUFDNUQ4RCxHQUFhSSxtQkFDYk4sR0FBY00sbUJBQ2RGLEdBQWdCRSxrQiIsInNvdXJjZXMiOlsid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29uc3RhbnRzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBDb25maXJtRGVsZXRlLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3V0aWxzL3V0aWxzLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8v0LrQu9Cw0YHRgSBDYXJkLCDQutC+0YLQvtGA0YvQuSDRgdC+0LfQtNCw0ZHRgiDQutCw0YDRgtC+0YfQutGDINGBINGC0LXQutGB0YLQvtC8INC4INGB0YHRi9C70LrQvtC5INC90LAg0LjQt9C+0LHRgNCw0LbQtdC90LjQtVxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gICAgY29uc3RydWN0b3IoZGF0YSwgdGVtcGxhdGVTZWxlY3RvciwgaGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVDb25maXJtQ2xpY2ssIGhhbmRsZUNhcmRMaWtlLCB1c2VySWQpIHtcbiAgICAgICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICAgICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICAgICAgdGhpcy5fdGVtcGxhdGVTZWxlY3RvciA9IHRlbXBsYXRlU2VsZWN0b3I7XG4gICAgICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcbiAgICAgICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xuICAgICAgICB0aGlzLl9jYXJkSWQgPSBkYXRhLl9pZDtcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgICAgICB0aGlzLl9oYW5kbGVDb25maXJtQ2xpY2sgPSBoYW5kbGVDb25maXJtQ2xpY2s7XG5cbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZExpa2UgPSBoYW5kbGVDYXJkTGlrZTtcbiAgICAgICAgdGhpcy5faXNMaWtlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcbiAgICB9XG5cbiAgICBfZ2V0VGVtcGxhdGUgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IpXG4gICAgICAgICAgICAuY29udGVudFxuICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50JylcbiAgICAgICAgICAgIC5jbG9uZU5vZGUodHJ1ZSlcbiAgICAgICAgcmV0dXJuIGNhcmRFbGVtZW50O1xuICAgIH1cblxuXG4gICAgICAvL9Cg0LDQsdC+0YLQsCDQutC90L7Qv9C60LggXCLQu9Cw0LnQulwiXG4gICAgICBfY2xpY2tMaWtlQnV0dG9uKCkge1xuICAgICAgICB0aGlzLl9idXR0b25MaWtlQ2FyZC5jbGFzc0xpc3QudG9nZ2xlKCdlbGVtZW50X19pY29uX2FjdGl2ZScpXG4gICAgfVxuXG4gICAgZ2V0IGlzTGlrZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzTGlrZTtcbiAgICB9XG5cbiAgICAvL9C80LXRgtC+0LQg0L/QvtC70YPRh9C10L3QuNGPINC70LDQudC60L7QsiBcbiAgICBnZXRMaWtlcyhsaWtlcykge1xuICAgICAgICB0aGlzLl9saWtlcyA9IGxpa2VzOyAvL9CyINC/0LXRgNC10LzQtdC90L3Rg9GOINC/0L7Qu9GD0YfQsNC10Lwg0L3QvtCy0L7QtSDQutC+0Lst0LLQviDQu9Cw0LnQutC+0LJcbiAgICAgICAgdGhpcy5fY291bnRlckxpa2VzLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoOzsgLy/Qt9Cw0L/QuNGB0YvQstCw0LXQvCDRjdGC0L4g0LrQvtC7LdCy0L4g0LIg0Y/Rh9C10LnQutGDXG4gICAgfVxuXG4gICAgLy/QvNC10YLQvtC0INC/0LXRgNC10LrQu9GO0YfQtdC90LjRjyDQutC90L7Qv9C60LhcbiAgICB0b2dnbGVMaWtlKCkge1xuICAgICAgICB0aGlzLl9idXR0b25MaWtlQ2FyZC5jbGFzc0xpc3QudG9nZ2xlKCdlbGVtZW50X19pY29uX2FjdGl2ZScpO1xuICAgIH1cblxuICAgIC8v0LzQtdGC0L7QtCDQtNC70Y8g0L/QtdGA0LXQutC70Y7Rh9C10L3QuNGPINCx0YPQu9C10LLRi9GFINC30L3QsNGH0LXQvdC40LlcbiAgICB0b2dnbGVJc0xpa2UoKXtcbiAgICAgICAgdGhpcy5faXNMaWtlID0gIXRoaXMuX2lzTGlrZTtcbiAgICB9XG5cbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XG5cbiAgICAgICB0aGlzLl9idXR0b25MaWtlQ2FyZCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2ljb24nKTtcblxuICAgICAgICB0aGlzLl9lbGVtZW50XG4gICAgICAgICAgICAucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2ljb24tdHJhc2gnKVxuICAgICAgICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZUNvbmZpcm1DbGljayh0aGlzLl9jYXJkSWQsIHRoaXMuX2VsZW1lbnQpXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl9idXR0b25MaWtlQ2FyZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLl9oYW5kbGVDYXJkTGlrZSh0aGlzLl9jYXJkSWQsIHRoaXMpO1xuICAgICAgICAgICAgfSlcblxuICAgICAgICB0aGlzLl9lbGVtZW50XG4gICAgICAgICAgICAucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX3Bob3RvJylcbiAgICAgICAgICAgIC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLl9nZXRDYXJkUG9wdXBJbWcoKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIGRlbGV0ZSgpIHtcbiAgICAgICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgICAgICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XG4gICAgfVxuXG4gICAgX2dldENhcmRQb3B1cEltZyA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspXG4gICAgfVxuXG4gICAgZ2VuZXJhdGVDYXJkID0gKCkgPT4ge1xuICAgICAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICAgICAgdGhpcy5fZWxlbWVudFBob3RvID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fcGhvdG8nKTtcbiAgICAgICAgdGhpcy5fZWxlbWVudFBob3RvLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgICAgIHRoaXMuX2VsZW1lbnRQaG90by5hbHQgPSB0aGlzLl9uYW1lO1xuICAgICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X190aXRsZScpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICAgICAgdGhpcy5fYnV0dG9uRGVsZXRlQ2FyZCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2ljb24tdHJhc2gnKTtcbiAgICAgICAgdGhpcy5fYnV0dG9uTGlrZUNhcmQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19pY29uJyk7XG4gICAgICAgIHRoaXMuX2NvdW50ZXJMaWtlcyA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX251bWJlcnMnKTtcbiAgICAgICAgdGhpcy5fY291bnRlckxpa2VzLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xuXG4gICAgICAgIGlmICh0aGlzLl91c2VySWQgIT09IHRoaXMuX293bmVySWQpIHtcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkRlbGV0ZUNhcmQucmVtb3ZlKCk7XG4gICAgICAgIH1cblxuICAgICAgICAgLy/QlNC+0LHQsNCy0LvRj9C10Lwg0L/RgNC+0LLQtdGA0LrRgyDQtdGB0YLRjCDQu9C4INGDINC60LDRgNGC0L7Rh9C60Lgg0LvQsNC50Log0LjQu9C4INC90LXRglxuICAgICAgICAgaWYgKHRoaXMuX2xpa2VzLmZpbmQoaXRlbSA9PiBpdGVtLl9pZCA9PT0gdGhpcy5fdXNlcklkKSkge1xuICAgICAgICAgICAgdGhpcy5fYnV0dG9uTGlrZUNhcmQuY2xhc3NMaXN0LmFkZCgnZWxlbWVudF9faWNvbl9hY3RpdmUnKTtcbiAgICAgICAgICAgIHRoaXMuX2lzTGlrZSA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgICB9XG59XG4iLCIvLyDQstCw0LvQuNC00LDRhtC40Y9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICAgIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgICAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpKTtcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgICB9XG5cbiAgICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0taW5wdXQtZXJyb3JgKTtcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmVycm9yQ2xhc3MpO1xuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG4gICAgfVxuXG4gICAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWlucHV0LWVycm9yYCk7XG4gICAgICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5lcnJvckNsYXNzKTtcbiAgICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbiAgICB9XG5cbiAgICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgICAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfaGFzSW52YWxpZElucHV0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4gKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpKTtcbiAgICB9XG5cbiAgICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xuICAgICAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgc2V0QnV0dG9uU3RhdGUoKSB7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgfVxuXG4gICAgY2xlYXJJbnB1dEVycm9yKCkge1xuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaChpbnB1dEVsZW1lbnQgPT4ge1xuICAgICAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgICAgfSk7XG4gICAgfVxufVxuIiwiXG5leHBvcnQgY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcbiAgICBmb3JtU2VsZWN0b3I6ICcucG9wdXBfX2Zvcm0nLCAvLyDRgdC10LvQtdC60YLQvtGAINGE0L7RgNC80YtcbiAgICBpbnB1dFNlbGVjdG9yOiAnLnBvcHVwX19pbnB1dCcsIC8vINGB0LXQu9C10LrRgtC+0YAgaW5wdXRcbiAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogJy5wb3B1cF9fYnV0dG9uJywvLyDRgdC10LvQtdC60YLQvtGAINC60L3QvtC/0LrQuCBzdWJtaXRcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiAncG9wdXBfX2J1dHRvbl9kaXNhYmxlZCcsLy8g0YHQvtGB0YLQvtGP0L3QuNC1INC60L3QvtC/0LrQuCBzdWJtaXRcbiAgICBpbnB1dEVycm9yQ2xhc3M6ICdwb3B1cF9faW5wdXRfdHlwZV9lcnJvcicsIC8vINC/0L7QtNGH0LXRgNC60LjQstCw0L3QuNC1INC60YDQsNGB0L3Ri9C8IGlucHV0XG4gICAgZXJyb3JDbGFzczogJ3BvcHVwX19lcnJvcl92aXNpYmxlJ1xufTsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgICBjb25zdHJ1Y3Rvcih7cmVuZGVyZXJ9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgICAgICB0aGlzLl9jb250YWluZXIgPVxuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7IC8vINC60YPQtNCwINC00L7QsdCw0LLQu9GP0LXQvCBcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjsgLy/RhNGD0L3QutC40YbRjyDQvtGC0YDQuNGB0L7QstC60Lgg0Lgg0YHQvtC30LTQsNC90LjRj1xuICAgIH1cblxuICAgIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XG4gICAgICAgIGl0ZW1zLnJldmVyc2UoKS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgIH1cblxuICAgIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgICAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgICAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBvcGVuKCkge1xuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9hY3RpdmUnKTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIH1cblxuICAgIGNsb3NlKCkge1xuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdwb3B1cF9hY3RpdmUnKTtcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIH1cblxuICAgIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcbiAgICAgICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcbiAgICAgICAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfYWN0aXZlJykgfHwgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwX19jbG9zZScpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICBcbiAgICB9XG59IiwiaW1wb3J0IFBvcHVwIGZyb20gJy4vUG9wdXAuanMnXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgZm9ybVN1Ym1pdCkge1xuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fZm9ybVN1Ym1pdCA9IGZvcm1TdWJtaXQ7IC8v0LrQvtC70LHQtdC6INGB0LDQvNCx0LjRgtCwINGE0L7RgNC80YtcbiAgICAgICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xuICAgICAgICB0aGlzLl9pbnB1dHMgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJy5wb3B1cF9faW5wdXQnKTtcbiAgICAgICAgdGhpcy5fYnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24nKTtcbiAgICB9XG5cbiAgICBjaGFuZ2VUZXh0KHRleHQpIHtcbiAgICB0aGlzLl9idXR0b24udGV4dENvbnRlbnQgPSB0ZXh0O1xuICAgfVxuXG4gICAgX2dldElucHV0VmFsdWVzKCkge1xuICAgICAgICAgdGhpcy5faW5wdXRzVmFsdWVzID0ge307XG4gICAgICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dHMpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2lucHV0c1ZhbHVlc1tpbnB1dHMubmFtZV0gPSBpbnB1dHMudmFsdWU7XG4gICAgICAgIH0pXG4gICAgICAgIHJldHVybiB0aGlzLl9pbnB1dHNWYWx1ZXM7XG4gICAgfVxuXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4ge1xuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLl9mb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgICAgICB9KSBcbiAgICB9XG5cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcbiAgICAgICAgdGhpcy5fZm9ybS5yZXNldCgpO1xuICAgIH1cbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fcG9wdXBJbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW1hZ2UnKTtcbiAgICAgICAgdGhpcy5fcG9wdXBUaXRsZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fdGl0bGUtaW1nJyk7XG4gICAgfVxuXG4gICAgb3BlbihsaW5rLCBuYW1lKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwSW1hZ2Uuc3JjID0gbGluaztcbiAgICAgICAgdGhpcy5fcG9wdXBJbWFnZS5hbHQgPSBuYW1lO1xuICAgICAgICB0aGlzLl9wb3B1cFRpdGxlLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICAgICAgXG4gICAgICAgIHN1cGVyLm9wZW4oKTtcbiAgICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICAgIGNvbnN0cnVjdG9yICh7bmFtZSwgYWJvdXQsIGF2YXRhciwgX3VzZXJJZH0pIHtcbiAgICAgICAgdGhpcy5fbmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMuX2Fib3V0ID0gYWJvdXQ7XG4gICAgICAgIHRoaXMuX2F2YXRhciA9IGF2YXRhcjtcbiAgICAgICAgdGhpcy5fdXNlcklkID0gX3VzZXJJZDtcbiAgICB9XG5cbiAgICBnZXRVc2VySW5mbyA9ICgpID0+IHsgLy8g0LLQvtC30LLRgNCw0YnQsNC10Lwg0L7QsdGK0LXQutGCINGBINC00LDQvdC90YvQvNC4INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRj1xuICAgICAgIHJldHVybiB7XG4gICAgICAgIG5hbWU6IHRoaXMuX25hbWUudGV4dENvbnRlbnQsXG4gICAgICAgIGFib3V0OiB0aGlzLl9hYm91dC50ZXh0Q29udGVudCxcbiAgICAgICAgYXZhdGFyOiB0aGlzLl9hdmF0YXIuc3JjLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHNldFVzZXJJbmZvID0gKHVzZXJEYXRhKSA9PiB7IC8vINC/0YDQuNC90LjQvNCw0LXQvCDQvdC+0LLRi9C1INC00LDQvdC90YvQtSDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y9cbiAgICAgICAgY29uc3Qge25hbWUsIGFib3V0LCBhdmF0YXJ9ID0gdXNlckRhdGE7XG4gICAgICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgICAgICB0aGlzLl9hYm91dC50ZXh0Q29udGVudCA9IGFib3V0O1xuICAgICAgICB0aGlzLl9hdmF0YXIuc3JjID0gYXZhdGFyO1xuICAgICAgICB0aGlzLl9hdmF0YXIuYWx0ID0gbmFtZTtcbiAgICB9XG5cbiAgICBnZXRVc2VySWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl91c2VySWQ7XG4gICAgfVxufSIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJ1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cENvbmZpcm1EZWxldGUgZXh0ZW5kcyBQb3B1cCB7XG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlQ29uZmlybUNsaWNrKSB7XG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9oYW5kbGVDb25maXJtQ2xpY2sgPSBoYW5kbGVDb25maXJtQ2xpY2suYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5fYnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24nKVxuICAgICAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtJyk7XG4gICAgfVxuXG4gICAgY2hhbmdlVGV4dCh0ZXh0KSB7XG4gICAgICAgIHRoaXMuX2J1dHRvbi50ZXh0Q29udGVudCA9IHRleHQ7XG4gICAgfVxuICAgIFxuICAgIG9wZW4oY2FyZElkLCBjYXJkSXRlbSkge1xuICAgICAgICBzdXBlci5vcGVuKCk7XG5cbiAgICAgICAgdGhpcy5fY2FyZElkID0gY2FyZElkO1xuICAgICAgICB0aGlzLl9jYXJkSXRlbSA9IGNhcmRJdGVtO1xuICAgIH1cblxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgICAgIHRoaXMuX2Zvcm1cbiAgICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5faGFuZGxlQ29uZmlybUNsaWNrKHRoaXMuX2NhcmRJZCwgdGhpcy5fY2FyZEl0ZW0sIHRoaXMuX2J1dHRvbilcbiAgICAgICAgICAgIHRoaXMuX2NhcmRJdGVtLnJlbW92ZSgpXG4gICAgICAgIH0pXG4gICAgfVxufSIsImV4cG9ydCBjb25zdCBwb3B1cFBob3RvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3Bob3RvJyk7XG5leHBvcnQgY29uc3QgcG9wdXBUaXRsZVBob3RvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbWFnZScpO1xuZXhwb3J0IGNvbnN0IHBvcHVwTGlua1Bob3RvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX190aXRsZS1pbWcnKTtcbmV4cG9ydCBjb25zdCBwb3B1cFByb2ZpbGVPcGVuQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQnKTtcbmV4cG9ydCBjb25zdCBwb3B1cEVkaXRQcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX2VkaXQtY2FyZCcpO1xuZXhwb3J0IGNvbnN0IGJ1dHRvbkFib3V0VXNlciA9IHBvcHVwRWRpdFByb2ZpbGUucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24nKVxuZXhwb3J0IGNvbnN0IGZvcm1FZGl0UHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xuZXhwb3J0IGNvbnN0IGZvcm1BZGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2FkZC1mb3JtJyk7XG5leHBvcnQgY29uc3QgaW5wdXRBZGRUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV90aXRsZScpO1xuZXhwb3J0IGNvbnN0IGlucHV0QWRkTGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV9saW5rJyk7XG5leHBvcnQgY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX25hbWUnKTtcbmV4cG9ydCBjb25zdCBhYm91dElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX2Fib3V0Jyk7XG5leHBvcnQgY29uc3QgbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX190aXRsZScpO1xuZXhwb3J0IGNvbnN0IGFib3V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX3N1YnRpdGxlJyk7XG5leHBvcnQgY29uc3QgZWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudHMnKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlQWRkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZCcpO1xuZXhwb3J0IGNvbnN0IHBvcHVwQWRkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX2FkZC1jYXJkJyk7XG5leHBvcnQgY29uc3QgYnV0dG9uc0Nsb3NlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19jbG9zZScpO1xuZXhwb3J0IGxldCB1c2VySWQgXG5leHBvcnQgY29uc3QgcG9wdXBCdXR0b25BdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9faWNvbi1lZGl0Jyk7XG5leHBvcnQgY29uc3QgZm9ybUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYXZhdGFyLWZvcm0nKTtcbmV4cG9ydCBjb25zdCBpbnB1dEF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV9hdmF0YXInKVxuZXhwb3J0IGNvbnN0IHVzZXJzRGF0YUVkaXQgPSB7XG4gICAgbmFtZTogbmFtZSxcbiAgICBhYm91dDogYWJvdXQsXG4gICAgYXZhdGFyOiBhdmF0YXIsXG59O1xuXG5leHBvcnQgY29uc3QgcG9wdXBTZWxlY3RvcnMgPSB7XG4gICAgcG9wdXBBZGRDYXJkOiAnLnBvcHVwX2FkZC1jYXJkJyxcbiAgICBwb3B1cEVkaXRQcm9maWxlOiAnLnBvcHVwX2VkaXQtY2FyZCcsXG4gICAgcG9wdXBXaXRoSW1nOiAnLnBvcHVwX3Bob3RvJyxcbiAgICBwb3B1cENvbmZpcm1EZWxldGU6ICcucG9wdXBfZGVsZXRlLWNhcmQnLFxuICAgIHBvcHVwQXZhdGFyOiAnLnBvcHVwX2F2YXRhcidcbn1cblxuZXhwb3J0IGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgdXJsOiAnaHR0cHM6Ly9tZXN0by5ub21vcmVwYXJ0aWVzLmNvL3YxL2NvaG9ydC02MCcsXG4gICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiAnZTI0ZGQ0OWEtNDEwMS00NTViLTlmYjUtMzExMDM4ZGZkNzA3JyxcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgIH1cbn1cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cbi8v0L/QvtC/0LDQvyDQvtGC0LrRgNGL0YLQuNC1IFxuZXhwb3J0IGZ1bmN0aW9uIG9wZW5Qb3B1cChwb3B1cEVsZW1lbnQpIHtcbiAgICBwb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgncG9wdXBfYWN0aXZlJyk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VQb3B1cEVzYyk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZVBvcHVwT3ZlcmZsb3cpO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIG9wZW5Qb3B1cEltZyhsaW5rLCBuYW1lKSB7XG4gICAgb3BlblBvcHVwKHBvcHVwUGhvdG8pO1xuICAgIHBvcHVwVGl0bGVQaG90by5zcmMgPSBuYW1lO1xuICAgIHBvcHVwVGl0bGVQaG90by5hbHQgPSBuYW1lO1xuICAgIHBvcHVwTGlua1Bob3RvLnRleHRDb250ZW50ID0gbGluaztcbn1cblxuLy/Qv9C+0L/QsNC/INC30LDQutGA0YvRgtC40LVcbmV4cG9ydCBmdW5jdGlvbiBjbG9zZVBvcHVwKHBvcHVwRWxlbWVudCkge1xuICAgIHBvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdwb3B1cF9hY3RpdmUnKVxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBjbG9zZVBvcHVwRXNjKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBjbG9zZVBvcHVwT3ZlcmZsb3cpO1xufVxuXG4vLyDQt9Cw0LrRgNGL0YLQuNC1INC/0L7Qv9Cw0L8g0L3QsCBlc2NcbmV4cG9ydCBmdW5jdGlvbiBjbG9zZVBvcHVwRXNjKGV2dCkge1xuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICAgIGNvbnN0IHBvcHVwRXNjID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX2FjdGl2ZScpXG4gICAgICAgIGNsb3NlUG9wdXAocG9wdXBFc2MpO1xuICAgIH1cbn1cblxuLy/Qt9Cw0LrRgNGL0YLQuNC1INC90LAgb3ZlcmZsb3dcbmV4cG9ydCBmdW5jdGlvbiBjbG9zZVBvcHVwT3ZlcmZsb3coZXZ0KSB7XG4gICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cCcpKSB7XG4gICAgICAgIGNsb3NlUG9wdXAoZXZ0LnRhcmdldCk7XG4gICAgfVxufVxuXG4iLCJcbmltcG9ydCBDYXJkIGZyb20gJy4uL2NvbXBvbmVudHMvQ2FyZC5qcyc7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tICcuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMnO1xuaW1wb3J0IHsgdmFsaWRhdGlvbkNvbmZpZyB9IGZyb20gJy4uL2NvbnN0YW50cy9jb25zdGFudHMuanMnO1xuaW1wb3J0ICcuL2luZGV4LmNzcyc7XG5pbXBvcnQgU2VjdGlvbiBmcm9tICcuLi9jb21wb25lbnRzL1NlY3Rpb24uanMnO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzJztcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzJztcbmltcG9ydCBVc2VySW5mbyBmcm9tICcuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzJ1xuaW1wb3J0IFBvcHVwQ29uZmlybURlbGV0ZSBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwQ29uZmlybURlbGV0ZS5qcydcblxuaW1wb3J0IHtcbiAgICAgcG9wdXBQcm9maWxlT3BlbkJ1dHRvbixcbiAgICAgZm9ybUVkaXRQcm9maWxlLCBmb3JtQWRkLFxuICAgIG5hbWVJbnB1dCwgYWJvdXRJbnB1dCwgIHByb2ZpbGVBZGQsIFxuICAgIHVzZXJzRGF0YUVkaXQsIHBvcHVwU2VsZWN0b3JzLCBvcHRpb25zLFxuICAgICAgcG9wdXBCdXR0b25BdmF0YXIsIGZvcm1BdmF0YXJcbn0gZnJvbSAnLi4vdXRpbHMvdXRpbHMuanMnO1xuaW1wb3J0IEFwaSBmcm9tICcuLi9jb21wb25lbnRzL0FwaS5qcyc7XG5cbmxldCB1c2VySWQ7XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkob3B0aW9ucyk7XG5cblByb21pc2UuYWxsKFthcGkuZ2V0SW5pdGlhbENhcmRzKCksIGFwaS5nZXRVc2VySW5mbygpXSlcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGNvbnN0IEluaXRpYWxDYXJkcyA9IHJlc1swXTtcbiAgICAgICAgY29uc3QgVXNlckluZm8gPSByZXNbMV07XG5cbiAgICAgICAgY2FyZExpc3QucmVuZGVySXRlbXMoSW5pdGlhbENhcmRzKTtcblxuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhVc2VySW5mbyk7XG4gICAgICAgIHVzZXJJbmZvLmdldFVzZXJJZChVc2VySW5mby5faWQpXG4gICAgICAgIHVzZXJJZCA9IFVzZXJJbmZvLl9pZFxuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KVxuXG5jb25zdCBjcmVhdGVDYXJkID0gKGl0ZW0pID0+IHtcbiAgICBjb25zdCBjYXJkID0gbmV3IENhcmQoaXRlbSwgJyNlbGVtZW50LXRlbXBsYXRlJyxcbiAgICAgICAgKCkgPT4geyBwb3B1cEltYWdlLm9wZW4oaXRlbS5saW5rLCBpdGVtLm5hbWUpIH0sXG4gICAgICAgIGhhbmRsZUNvbmZpcm1DbGljayxcbiAgICAgICAgKGNhcmRJZCkgPT4ge1xuICAgICAgICAgICAgaWYgKGNhcmQuaXNMaWtlKSB7XG4gICAgICAgICAgICAgICAgYXBpLmRlbGV0ZUxpa2VzKGNhcmRJZClcbiAgICAgICAgICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICAgICAgICBjYXJkLmdldExpa2VzKHJlcy5saWtlcyk7XG4gICAgICAgICAgICAgICAgICBjYXJkLnRvZ2dsZUlzTGlrZSgpO1xuICAgICAgICAgICAgICAgICAgY2FyZC50b2dnbGVMaWtlKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIGFwaS5zZXRMaWtlcyhjYXJkSWQpXG4gICAgICAgICAgICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgY2FyZC5nZXRMaWtlcyhyZXMubGlrZXMpO1xuICAgICAgICAgICAgICAgICAgICAgIGNhcmQudG9nZ2xlSXNMaWtlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgY2FyZC50b2dnbGVMaWtlKCk7XG4gICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAsdXNlcklkKVxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XG59XG5cblxuZnVuY3Rpb24gaGFuZGxlQ29uZmlybUNsaWNrKGNhcmRJZCwgY2FyZEl0ZW0pIHtcbiAgICBwb3B1cENvbmZpcm1EZWxldGVDYXJkLm9wZW4oY2FyZElkLCBjYXJkSXRlbSlcbn1cblxuY29uc3QgY2FyZExpc3QgPSBuZXcgU2VjdGlvbihcbiAgICB7XG4gICAgICAgIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQoaXRlbSk7XG4gICAgICAgICAgICBjYXJkTGlzdC5hZGRJdGVtKGNhcmQpO1xuICAgICAgICB9XG4gICAgfVxuICAgICwgJy5lbGVtZW50cycpXG5cbi8vINC+0YLQvtCx0YDQsNC20LXQvdC40LUg0LjQvdGE0L7RgNC80LDRhtC40Lgg0L4g0L/QvtC70YzQt9C+0LLQsNGC0LXQu9C4IFxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8odXNlcnNEYXRhRWRpdCk7XG5cblxuY29uc3QgcG9wdXBBYm91dFVzZXJzID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gICAgcG9wdXBTZWxlY3RvcnMucG9wdXBFZGl0UHJvZmlsZSxcbiAgICAodXNlckRhdGEpID0+IHtcbiAgICAgICAgcG9wdXBBYm91dFVzZXJzLmNoYW5nZVRleHQoJ9Ch0L7RhdGA0LDQvdC10L3QuNC1Li4uJylcbiAgICAgICAgYXBpLnNldEluZm9Vc2VyKHVzZXJEYXRhKVxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHJlcyk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHBvcHVwQWJvdXRVc2Vycy5jaGFuZ2VUZXh0KCfQodC+0YXRgNCw0L3QuNGC0YwnKTtcbiAgICAgICAgICAgICAgICBwb3B1cEFib3V0VXNlcnMuY2xvc2UoKVxuICAgICAgICAgICAgfSlcbiAgICB9LFxuKTtcblxuY29uc3QgcG9wdXBBZGRDYXJkID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gICAgcG9wdXBTZWxlY3RvcnMucG9wdXBBZGRDYXJkLFxuICAgIChpdGVtKSA9PiB7XG4gICAgICAgIHBvcHVwQWRkQ2FyZC5jaGFuZ2VUZXh0KCfQodC+0YXRgNCw0L3QtdC90LjQtS4uLicpXG4gICAgICAgIGFwaS5jcmVhdGVOZXdDYXJkKGl0ZW0pXG4gICAgICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQocmVzKTtcbiAgICAgICAgICAgICAgICBjYXJkTGlzdC5hZGRJdGVtKGNhcmQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICAgICAgICBwb3B1cEFkZENhcmQuY2hhbmdlVGV4dCgn0KHQvtGF0YDQsNC90LjRgtGMJylcbiAgICAgICAgICAgICAgICBwb3B1cEFkZENhcmQuY2xvc2UoKVxuICAgICAgICAgICAgfSlcbiAgICB9KTtcblxuY29uc3QgcG9wdXBDb25maXJtRGVsZXRlQ2FyZCA9IG5ldyBQb3B1cENvbmZpcm1EZWxldGUoXG4gICAgcG9wdXBTZWxlY3RvcnMucG9wdXBDb25maXJtRGVsZXRlLFxuICAgIChjYXJkSWQsIGNhcmRJdGVtLCkgPT4ge1xuICAgICAgICBwb3B1cENvbmZpcm1EZWxldGVDYXJkLmNoYW5nZVRleHQoJ9Cj0LTQsNC70LXQvdC40LUuLi4nKVxuICAgICAgICBhcGkuZGVsZXRlQ2FyZChjYXJkSWQpXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNhcmRJdGVtLmRlbGV0ZSgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICBwb3B1cENvbmZpcm1EZWxldGVDYXJkLmNsb3NlKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICAgICAgICBwb3B1cENvbmZpcm1EZWxldGVDYXJkLmNoYW5nZVRleHQoJ9CU0LAnKVxuICAgICAgICAgICAgICAgIHBvcHVwQ29uZmlybURlbGV0ZUNhcmQuY2xvc2UoKVxuICAgICAgICAgICAgfSlcblxuICAgIH1cbilcblxuY29uc3QgcG9wdXBJbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZShwb3B1cFNlbGVjdG9ycy5wb3B1cFdpdGhJbWcpO1xuXG4vL9Cw0LLQsNGC0LDRgCDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y9cbmNvbnN0IHBvcHVwVXNlckF2YXRhciA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICAgIHBvcHVwU2VsZWN0b3JzLnBvcHVwQXZhdGFyLFxuICAgIChuZXdBdmF0YXJMaW5rKSA9PiB7XG4gICAgICAgIHBvcHVwVXNlckF2YXRhci5jaGFuZ2VUZXh0KCfQodC+0YXRgNCw0L3QtdC90LjQtS4uLicpXG4gICAgICAgIGFwaS5zZXRVc2VyQXZhdGFyKG5ld0F2YXRhckxpbmsubGluaylcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIHBvcHVwVXNlckF2YXRhci5jbG9zZSgpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICAgICAgICBwb3B1cFVzZXJBdmF0YXIuY2hhbmdlVGV4dCgn0KHQvtGF0YDQsNC90LjRgtGMJylcbiAgICAgICAgICAgICAgICBwb3B1cFVzZXJBdmF0YXIuY2xvc2UoKVxuICAgICAgICAgICAgfSlcbiAgICB9XG4pXG5cbi8v0L/QvtC/0LDQvyDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNGPINC/0YDQvtGE0LjQu9GPXG5wb3B1cFByb2ZpbGVPcGVuQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxcbiAgICAoZXZ0KSA9PiB7XG4gICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBjb25zdCB7IG5hbWUsIGFib3V0IH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICAgICAgICBuYW1lSW5wdXQudmFsdWUgPSBuYW1lO1xuICAgICAgICBhYm91dElucHV0LnZhbHVlID0gYWJvdXQ7XG4gICAgICAgIHBvcHVwQWJvdXRVc2Vycy5vcGVuKCk7XG4gICAgICAgIGZvcm1WYWxpZEVkaXQuY2xlYXJJbnB1dEVycm9yKCk7XG4gICAgfSk7XG4vL9C/0L7Qv9Cw0L8g0LTQvtCx0LDQstC70LXQvdC40Y8g0LrQsNGA0YLQvtGH0LrQuFxucHJvZmlsZUFkZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsXG4gICAgKCkgPT4ge1xuICAgICAgICBwb3B1cEFkZENhcmQub3BlbigpO1xuICAgICAgICBmb3JtVmFsaWRBZGQuc2V0QnV0dG9uU3RhdGUoKTtcbiAgICB9KTtcblxucG9wdXBCdXR0b25BdmF0YXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLFxuICAgICgpID0+IHtcbiAgICAgICAgcG9wdXBVc2VyQXZhdGFyLm9wZW4oKVxuICAgICAgICBmb3JtVmFsaWRBdmF0YXIuc2V0QnV0dG9uU3RhdGUoKVxuICAgIH1cbilcblxucG9wdXBBYm91dFVzZXJzLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5wb3B1cEFkZENhcmQuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbnBvcHVwSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbnBvcHVwQ29uZmlybURlbGV0ZUNhcmQuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbnBvcHVwVXNlckF2YXRhci5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vL9Cy0LDQu9C40LTQsNGG0LjRjyDRhNC+0YDQvNGLXG5jb25zdCBmb3JtVmFsaWRBZGQgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uQ29uZmlnLCBmb3JtQWRkKTtcbmNvbnN0IGZvcm1WYWxpZEVkaXQgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uQ29uZmlnLCBmb3JtRWRpdFByb2ZpbGUpO1xuY29uc3QgZm9ybVZhbGlkQXZhdGFyID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvbkNvbmZpZywgZm9ybUF2YXRhcik7XG5mb3JtVmFsaWRBZGQuZW5hYmxlVmFsaWRhdGlvbigpO1xuZm9ybVZhbGlkRWRpdC5lbmFibGVWYWxpZGF0aW9uKCk7XG5mb3JtVmFsaWRBdmF0YXIuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gICAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgICAgICB0aGlzLl91cmwgPSBvcHRpb25zLnVybDtcbiAgICAgICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycztcbiAgICB9XG5cbiAgICBfY2hlY2tTdGF0dXNSZXMocmVzKSB7XG4gICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YClcbiAgICB9XG5cbiAgICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzYCwge1xuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4ocmVzID0+IHRoaXMuX2NoZWNrU3RhdHVzUmVzKHJlcykpXG4gICAgfVxuXG4gICAgZ2V0VXNlckluZm8oKSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lYCwge1xuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihyZXMgPT4gdGhpcy5fY2hlY2tTdGF0dXNSZXMocmVzKSlcbiAgICB9XG5cbiAgICBzZXRJbmZvVXNlcih7IG5hbWUsIGFib3V0IH0pIHtcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWVgLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICAgICAgYWJvdXQ6IGFib3V0LFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4ocmVzID0+IHRoaXMuX2NoZWNrU3RhdHVzUmVzKHJlcykpXG4gICAgfVxuXG4gICAgY3JlYXRlTmV3Q2FyZChpdGVtKSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzYCwge1xuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIG5hbWU6IGl0ZW0ubmFtZSxcbiAgICAgICAgICAgICAgICBsaW5rOiBpdGVtLmxpbmssXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgICAgICAudGhlbihyZXMgPT4gdGhpcy5fY2hlY2tTdGF0dXNSZXMocmVzKSlcbiAgICB9XG5cbiAgICBkZWxldGVDYXJkKGNhcmRJZCkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy8ke2NhcmRJZH1gLHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgICB9KVxuICAgICAgICAudGhlbihyZXMgPT4gdGhpcy5fY2hlY2tTdGF0dXNSZXMocmVzKSlcbiAgICB9XG5cbiAgICBzZXRMaWtlcyhjYXJkSWQpIHtcbiAgICAgICAgcmV0dXJuIGZldGNoIChgJHt0aGlzLl91cmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICBtZXRob2Q6ICdQVVQnXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHJlcyA9PiB0aGlzLl9jaGVja1N0YXR1c1JlcyhyZXMpKVxuICAgIH1cblxuICAgIGRlbGV0ZUxpa2VzKGNhcmRJZCkge1xuICAgICAgICByZXR1cm4gZmV0Y2ggKGAke3RoaXMuX3VybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURSdcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4ocmVzID0+IHRoaXMuX2NoZWNrU3RhdHVzUmVzKHJlcykpXG4gICAgfSBcblxuICAgIHNldFVzZXJBdmF0YXIobmV3QXZhdGFyTGluaykge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIGF2YXRhcjogbmV3QXZhdGFyTGluaywgXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgICAgICAudGhlbihyZXMgPT4gdGhpcy5fY2hlY2tTdGF0dXNSZXMocmVzKSlcbiAgICB9XG59Il0sIm5hbWVzIjpbIkNhcmQiLCJkYXRhIiwidGVtcGxhdGVTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZUNvbmZpcm1DbGljayIsImhhbmRsZUNhcmRMaWtlIiwidXNlcklkIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiX3RlbXBsYXRlU2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2J1dHRvbkxpa2VDYXJkIiwiX2VsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhbmRsZUNvbmZpcm1DbGljayIsIl9jYXJkSWQiLCJfaGFuZGxlQ2FyZExpa2UiLCJfZ2V0Q2FyZFBvcHVwSW1nIiwiX2hhbmRsZUNhcmRDbGljayIsIl9uYW1lIiwiX2xpbmsiLCJfZ2V0VGVtcGxhdGUiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfZWxlbWVudFBob3RvIiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJfYnV0dG9uRGVsZXRlQ2FyZCIsIl9jb3VudGVyTGlrZXMiLCJfbGlrZXMiLCJsZW5ndGgiLCJfdXNlcklkIiwiX293bmVySWQiLCJyZW1vdmUiLCJmaW5kIiwiaXRlbSIsIl9pZCIsImNsYXNzTGlzdCIsImFkZCIsIl9pc0xpa2UiLCJ0aGlzIiwibmFtZSIsImxpbmsiLCJvd25lciIsImxpa2VzIiwidG9nZ2xlIiwiRm9ybVZhbGlkYXRvciIsImNvbmZpZyIsImZvcm1FbGVtZW50IiwiX2NvbmZpZyIsIl9mb3JtRWxlbWVudCIsIl9pbnB1dExpc3QiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXRTZWxlY3RvciIsIl9idXR0b25FbGVtZW50Iiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvckVsZW1lbnQiLCJpZCIsImVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJzb21lIiwiX2hhc0ludmFsaWRJbnB1dCIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJkaXNhYmxlZCIsImZvckVhY2giLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZSIsInByZXZlbnREZWZhdWx0IiwidmFsaWRhdGlvbkNvbmZpZyIsImZvcm1TZWxlY3RvciIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiX2NvbnRhaW5lciIsIl9yZW5kZXJlciIsIml0ZW1zIiwicmV2ZXJzZSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJjbG9zZSIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImZvcm1TdWJtaXQiLCJfZm9ybVN1Ym1pdCIsIl9mb3JtIiwiX2lucHV0cyIsIl9idXR0b24iLCJ0ZXh0IiwiX2lucHV0c1ZhbHVlcyIsImlucHV0cyIsInZhbHVlIiwiX2dldElucHV0VmFsdWVzIiwicmVzZXQiLCJQb3B1cFdpdGhJbWFnZSIsIl9wb3B1cEltYWdlIiwiX3BvcHVwVGl0bGUiLCJVc2VySW5mbyIsImFib3V0IiwiYXZhdGFyIiwiX2Fib3V0IiwiX2F2YXRhciIsInVzZXJEYXRhIiwiUG9wdXBDb25maXJtRGVsZXRlIiwiY2FyZElkIiwiY2FyZEl0ZW0iLCJfY2FyZEl0ZW0iLCJwb3B1cFByb2ZpbGVPcGVuQnV0dG9uIiwiZm9ybUVkaXRQcm9maWxlIiwiZm9ybUFkZCIsIm5hbWVJbnB1dCIsImFib3V0SW5wdXQiLCJwcm9maWxlQWRkIiwicG9wdXBCdXR0b25BdmF0YXIiLCJmb3JtQXZhdGFyIiwidXNlcnNEYXRhRWRpdCIsIkFwaSIsIm9wdGlvbnMiLCJfdXJsIiwidXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImZldGNoIiwidGhlbiIsIl9jaGVja1N0YXR1c1JlcyIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwibmV3QXZhdGFyTGluayIsImFwaSIsImF1dGhvcml6YXRpb24iLCJhbGwiLCJnZXRJbml0aWFsQ2FyZHMiLCJnZXRVc2VySW5mbyIsIkluaXRpYWxDYXJkcyIsImNhcmRMaXN0IiwicmVuZGVySXRlbXMiLCJ1c2VySW5mbyIsInNldFVzZXJJbmZvIiwiZ2V0VXNlcklkIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiY3JlYXRlQ2FyZCIsImNhcmQiLCJwb3B1cEltYWdlIiwib3BlbiIsImlzTGlrZSIsImRlbGV0ZUxpa2VzIiwiZ2V0TGlrZXMiLCJ0b2dnbGVJc0xpa2UiLCJ0b2dnbGVMaWtlIiwic2V0TGlrZXMiLCJnZW5lcmF0ZUNhcmQiLCJwb3B1cENvbmZpcm1EZWxldGVDYXJkIiwiYWRkSXRlbSIsInBvcHVwQWJvdXRVc2VycyIsImNoYW5nZVRleHQiLCJzZXRJbmZvVXNlciIsImZpbmFsbHkiLCJwb3B1cEFkZENhcmQiLCJjcmVhdGVOZXdDYXJkIiwiZGVsZXRlQ2FyZCIsImRlbGV0ZSIsInBvcHVwVXNlckF2YXRhciIsInNldFVzZXJBdmF0YXIiLCJmb3JtVmFsaWRFZGl0IiwiY2xlYXJJbnB1dEVycm9yIiwiZm9ybVZhbGlkQWRkIiwic2V0QnV0dG9uU3RhdGUiLCJmb3JtVmFsaWRBdmF0YXIiLCJzZXRFdmVudExpc3RlbmVycyIsImVuYWJsZVZhbGlkYXRpb24iXSwic291cmNlUm9vdCI6IiJ9