(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,r(o.key),o)}}function n(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(t){var n=function(t,n){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===e(n)?n:String(n)}var o=function(){function e(t,r,o,i,u,c){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n(this,"_getTemplate",(function(){return document.querySelector(a._templateSelector).content.querySelector(".element").cloneNode(!0)})),n(this,"_setEventListeners",(function(){a._buttonLikeCard=a._element.querySelector(".element__icon"),a._element.querySelector(".element__icon-trash").addEventListener("click",(function(){a._handleConfirmClick(a._cardId,a._element)})),a._buttonLikeCard.addEventListener("click",(function(){a._handleCardLike(a._cardId,a)})),a._element.querySelector(".element__photo").addEventListener("click",(function(){a._getCardPopupImg()}))})),n(this,"_getCardPopupImg",(function(){a._handleCardClick(a._name,a._link)})),n(this,"generateCard",(function(){return a._element=a._getTemplate(),a._setEventListeners(),a._elementPhoto=a._element.querySelector(".element__photo"),a._elementPhoto.src=a._link,a._elementPhoto.alt=a._name,a._element.querySelector(".element__title").textContent=a._name,a._buttonDeleteCard=a._element.querySelector(".element__icon-trash"),a._buttonLikeCard=a._element.querySelector(".element__icon"),a._counterLikes=a._element.querySelector(".element__numbers"),a._counterLikes.textContent=a._likes.length,a._userId!==a._ownerId&&a._buttonDeleteCard.remove(),a._likes.find((function(e){return e._id===a._userId}))&&(a._buttonLikeCard.classList.add("element__icon_active"),a._isLike=!0),a._element})),this._name=t.name,this._link=t.link,this._templateSelector=r,this._userId=c,this._ownerId=t.owner._id,this._cardId=t._id,this._handleCardClick=o,this._handleConfirmClick=i,this._handleCardLike=u,this._isLike=!1,this._likes=t.likes}var r,o;return r=e,(o=[{key:"_clickLikeButton",value:function(){this._buttonLikeCard.classList.toggle("element__icon_active")}},{key:"isLike",get:function(){return this._isLike}},{key:"setLikes",value:function(e){this._likes=e,this._counterLikes.textContent=this._likes.length}},{key:"toggleLike",value:function(){this._buttonLikeCard.classList.toggle("element__icon_active")}},{key:"toggleIsLike",value:function(){this._isLike=!this._isLike}},{key:"delete",value:function(){this._element.remove(),this._element=null}}])&&t(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),e}();function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===i(o)?o:String(o)),r)}var o}var c=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._config=t,this._formElement=n,this._inputList=Array.from(n.querySelectorAll(t.inputSelector)),this._buttonElement=n.querySelector(t.submitButtonSelector)}var t,n;return t=e,(n=[{key:"_hideInputError",value:function(e){var t=this._formElement.querySelector(".".concat(e.id,"-input-error"));t.classList.remove(this._config.errorClass),t.textContent="",e.classList.remove(this._config.inputErrorClass)}},{key:"_showInputError",value:function(e){var t=this._formElement.querySelector(".".concat(e.id,"-input-error"));t.classList.add(this._config.errorClass),t.textContent=e.validationMessage,e.classList.add(this._config.inputErrorClass)}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(e){return!e.validity.valid}))}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._config.inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._config.inactiveButtonClass),this._buttonElement.disabled=!1)}},{key:"_setEventListeners",value:function(){var e=this;this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._setEventListeners()}},{key:"setButtonState",value:function(){this._toggleButtonState()}},{key:"clearInputError",value:function(){var e=this;this._inputList.forEach((function(t){e._checkInputValidity(t)}))}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),a={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==l(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===l(o)?o:String(o)),r)}var o}var f=function(){function e(t,n){var r=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._container=document.querySelector(n),this._renderer=r}var t,n;return t=e,(n=[{key:"renderItems",value:function(e){var t=this;e.reverse().forEach((function(e){t._renderer(e)}))}},{key:"addItem",value:function(e){this._container.prepend(e)}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==p(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===p(o)?o:String(o)),r)}var o}var _=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popup=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}var t,n;return t=e,(n=[{key:"open",value:function(){this._popup.classList.add("popup_active"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.remove("popup_active"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"setEventListeners",value:function(){var e=this;this._popup.addEventListener("mousedown",(function(t){(t.target.classList.contains("popup_active")||t.target.classList.contains("popup__close"))&&e.close()}))}}])&&y(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==h(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==h(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===h(o)?o:String(o)),r)}var o}function m(){return m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=v(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},m.apply(this,arguments)}function v(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=S(e)););return e}function b(e,t){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},b(e,t)}function g(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}var k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=S(r);if(o){var n=S(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return g(this,e)});function u(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,e))._formSubmit=t,n._form=n._popup.querySelector(".popup__form"),n._inputs=n._form.querySelectorAll(".popup__input"),n._button=n._popup.querySelector(".popup__button"),n}return t=u,(n=[{key:"changeText",value:function(e){this._button.textContent=e}},{key:"_getInputValues",value:function(){var e=this;return this._inputsValues={},this._inputs.forEach((function(t){e._inputsValues[t.name]=t.value})),this._inputsValues}},{key:"setEventListeners",value:function(){var e=this;m(S(u.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(t){t.preventDefault(),e._formSubmit(e._getInputValues())}))}},{key:"close",value:function(){m(S(u.prototype),"close",this).call(this),this._form.reset()}}])&&d(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(_);function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==w(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===w(o)?o:String(o)),r)}var o}function L(){return L="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=P(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},L.apply(this,arguments)}function P(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=C(e)););return e}function O(e,t){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},O(e,t)}function j(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function C(e){return C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},C(e)}var I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=C(r);if(o){var n=C(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return j(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this,e))._popupImage=t._popup.querySelector(".popup__image"),t._popupTitle=t._popup.querySelector(".popup__title-img"),t}return t=u,(n=[{key:"open",value:function(e,t){this._popupImage.src=e,this._popupImage.alt=t,this._popupTitle.textContent=t,L(C(u.prototype),"open",this).call(this)}}])&&E(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(_);function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,x(r.key),r)}}function R(e,t,n){return(t=x(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e){var t=function(e,t){if("object"!==q(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==q(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===q(t)?t:String(t)}var B=function(){function e(t){var n=this,r=t.name,o=t.about,i=t.avatar,u=t._userId;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),R(this,"getUserInfo",(function(){return{name:n._name.textContent,about:n._about.textContent,avatar:n._avatar.src}})),R(this,"setUserInfo",(function(e){var t=e.name,r=e.about,o=e.avatar,i=e._userId;n._name.textContent=t,n._about.textContent=r,n._avatar.src=o,n._avatar.alt=t,n._userId=i})),this._name=document.querySelector(r),this._about=document.querySelector(o),this._avatar=document.querySelector(i),this._userId=u}var t,n;return t=e,(n=[{key:"getUserId",value:function(){return this._userId}}])&&T(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function U(e){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U(e)}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==U(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==U(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===U(o)?o:String(o)),r)}var o}function V(){return V="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=A(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},V.apply(this,arguments)}function A(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=M(e)););return e}function N(e,t){return N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},N(e,t)}function J(e,t){if(t&&("object"===U(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return H(e)}function H(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M(e){return M=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},M(e)}var z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=M(r);if(o){var n=M(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return J(this,e)});function u(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,e))._handleConfirmClick=t.bind(H(n)),n._button=n._popup.querySelector(".popup__button"),n._form=n._popup.querySelector(".popup__form"),n}return t=u,(n=[{key:"changeText",value:function(e){this._button.textContent=e}},{key:"open",value:function(e,t){V(M(u.prototype),"open",this).call(this),this._cardId=e,this._cardItem=t}},{key:"setEventListeners",value:function(){var e=this;V(M(u.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(t){t.preventDefault(),e._handleConfirmClick(e._cardId,e._cardItem,e._button)}))}}])&&D(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(_),F=(document.querySelector(".popup_photo"),document.querySelector(".popup__image"),document.querySelector(".popup__title-img"),document.querySelector(".profile__edit")),G=(document.querySelector(".popup_edit-card").querySelector(".popup__button"),document.querySelector(".popup__form")),K=document.querySelector(".popup__add-form"),Q=(document.querySelector(".popup__input_type_title"),document.querySelector(".popup__input_type_link"),document.querySelector(".popup__input_type_name")),W=document.querySelector(".popup__input_type_about"),X=(document.querySelector(".profile__title"),document.querySelector(".profile__subtitle"),document.querySelector(".elements"),document.querySelector(".profile__add")),Y=(document.querySelector(".popup_add-card"),document.querySelectorAll(".popup__close"),document.querySelector(".profile__icon-edit")),Z=document.querySelector(".popup__avatar-form"),$=(document.querySelector(".popup__input_type_avatar"),".popup_add-card");function ee(e){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(e)}function te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==ee(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ee(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===ee(o)?o:String(o)),r)}var o}var ne,re=new(function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._url=t.url,this._headers=t.headers}var t,n;return t=e,(n=[{key:"_checkStatusRes",value:function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}},{key:"getInitialCards",value:function(){var e=this;return fetch("".concat(this._url,"/cards"),{headers:this._headers}).then((function(t){return e._checkStatusRes(t)}))}},{key:"getUserInfo",value:function(){var e=this;return fetch("".concat(this._url,"/users/me"),{headers:this._headers}).then((function(t){return e._checkStatusRes(t)}))}},{key:"setInfoUser",value:function(e){var t=this,n=e.name,r=e.about;return fetch("".concat(this._url,"/users/me"),{headers:this._headers,method:"PATCH",body:JSON.stringify({name:n,about:r})}).then((function(e){return t._checkStatusRes(e)}))}},{key:"createNewCard",value:function(e){var t=this;return fetch("".concat(this._url,"/cards"),{headers:this._headers,method:"POST",body:JSON.stringify({name:e.name,link:e.link})}).then((function(e){return t._checkStatusRes(e)}))}},{key:"deleteCard",value:function(e){var t=this;return fetch("".concat(this._url,"/cards/").concat(e),{headers:this._headers,method:"DELETE"}).then((function(e){return t._checkStatusRes(e)}))}},{key:"setLikes",value:function(e){var t=this;return fetch("".concat(this._url,"/cards/").concat(e,"/likes"),{headers:this._headers,method:"PUT"}).then((function(e){return t._checkStatusRes(e)}))}},{key:"deleteLikes",value:function(e){var t=this;return fetch("".concat(this._url,"/cards/").concat(e,"/likes"),{headers:this._headers,method:"DELETE"}).then((function(e){return t._checkStatusRes(e)}))}},{key:"setUserAvatar",value:function(e){var t=this;return fetch("".concat(this._url,"/users/me/avatar"),{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})}).then((function(e){return t._checkStatusRes(e)}))}}])&&te(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}())({url:"https://mesto.nomoreparties.co/v1/cohort-60",headers:{authorization:"e24dd49a-4101-455b-9fb5-311038dfd707","Content-Type":"application/json"}});Promise.all([re.getInitialCards(),re.getUserInfo()]).then((function(e){var t=e[0],n=e[1];ue.renderItems(t),ce.setUserInfo(n),ce.getUserId(n._id),ne=n._id})).catch((function(e){console.log(e)}));var oe=function(e){var t=new o(e,"#element-template",(function(){fe.open(e.link,e.name)}),ie,(function(e){t.isLike?re.deleteLikes(e).then((function(e){t.setLikes(e.likes),t.toggleIsLike(),t.toggleLike()})).catch((function(e){console.log(e)})):re.setLikes(e).then((function(e){t.setLikes(e.likes),t.toggleIsLike(),t.toggleLike()})).catch((function(e){console.log(e)}))}),ne);return t.generateCard()};function ie(e,t){se.open(e,t)}var ue=new f({renderer:function(e){var t=oe(e);ue.addItem(t)}},".elements"),ce=new B({name:".profile__title",about:".profile__subtitle",avatar:".profile__avatar"}),ae=new k(".popup_edit-card",(function(e){ae.changeText("Сохранение..."),re.setInfoUser(e).then((function(e){ce.setUserInfo(e)})).then((function(){ae.close()})).catch((function(e){console.log(e)})).finally((function(){ae.changeText("Сохранить")}))})),le=new k($,(function(e){le.changeText("Сохранение..."),re.createNewCard(e).then((function(e){var t=oe(e);ue.addItem(t)})).then((function(){le.close()})).catch((function(e){console.log(e)})).finally((function(){le.changeText("Сохранить")}))})),se=new z(".popup_delete-card",(function(e,t){se.changeText("Удаление..."),re.deleteCard(e).then((function(){t.remove()})).then((function(){se.close()})).catch((function(e){console.log(e)})).finally((function(){se.changeText("Да")}))})),fe=new I(".popup_photo"),pe=new k(".popup_avatar",(function(e){pe.changeText("Сохранение..."),re.setUserAvatar(e.link).then((function(e){ce.setUserInfo(e)})).then((function(){pe.close()})).catch((function(e){console.log(e)})).finally((function(){pe.changeText("Сохранить")}))}));F.addEventListener("click",(function(e){e.preventDefault();var t=ce.getUserInfo(),n=t.name,r=t.about;Q.value=n,W.value=r,ae.open(),_e.clearInputError()})),X.addEventListener("click",(function(){le.open(),ye.setButtonState()})),Y.addEventListener("click",(function(){pe.open(),he.setButtonState()})),ae.setEventListeners(),le.setEventListeners(),fe.setEventListeners(),se.setEventListeners(),pe.setEventListeners();var ye=new c(a,K),_e=new c(a,G),he=new c(a,Z);ye.enableValidation(),_e.enableValidation(),he.enableValidation()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RndDLEdBQWdCM0YsT0FDcEIsSUFDQ29FLE9BQU0sU0FBQ0MsR0FDSkMsUUFBUUMsSUFBSUYsRUFDaEIsSUFDQ2tCLFNBQVEsV0FDTEksR0FBZ0JOLFdBQVcsWUFDL0IsR0FDUixJQUlKeEQsRUFBdUI5RyxpQkFBaUIsU0FDcEMsU0FBQytFLEdBQ0dBLEVBQUllLGlCQUNKLE1BQXdCb0QsR0FBU0osY0FBekJsSCxFQUFJLEVBQUpBLEtBQU15RSxFQUFLLEVBQUxBLE1BQ2RZLEVBQVVwQixNQUFRakUsRUFDbEJzRixFQUFXckIsTUFBUVEsRUFDbkJnRSxHQUFnQlQsT0FDaEJrQixHQUFjQyxpQkFDbEIsSUFFSjVELEVBQVduSCxpQkFBaUIsU0FDeEIsV0FDSXlLLEdBQWFiLE9BQ2JvQixHQUFhQyxnQkFDakIsSUFFSjdELEVBQWtCcEgsaUJBQWlCLFNBQy9CLFdBQ0k0SyxHQUFnQmhCLE9BQ2hCc0IsR0FBZ0JELGdCQUNwQixJQUdKWixHQUFnQmMsb0JBQ2hCVixHQUFhVSxvQkFDYnhCLEdBQVd3QixvQkFDWGhCLEdBQXVCZ0Isb0JBQ3ZCUCxHQUFnQk8sb0JBR2hCLElBQU1ILEdBQWUsSUFBSS9JLEVBQWM2QixFQUFrQmtELEdBQ25EOEQsR0FBZ0IsSUFBSTdJLEVBQWM2QixFQUFrQmlELEdBQ3BEbUUsR0FBa0IsSUFBSWpKLEVBQWM2QixFQUFrQnVELEdBQzVEMkQsR0FBYUksbUJBQ2JOLEdBQWNNLG1CQUNkRixHQUFnQkUsa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbnN0YW50cy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwQ29uZmlybURlbGV0ZS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy91dGlscy91dGlscy5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvL9C60LvQsNGB0YEgQ2FyZCwg0LrQvtGC0L7RgNGL0Lkg0YHQvtC30LTQsNGR0YIg0LrQsNGA0YLQvtGH0LrRgyDRgSDRgtC10LrRgdGC0L7QvCDQuCDRgdGB0YvQu9C60L7QuSDQvdCwINC40LfQvtCx0YDQsNC20LXQvdC40LVcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICAgIGNvbnN0cnVjdG9yKGRhdGEsIHRlbXBsYXRlU2VsZWN0b3IsIGhhbmRsZUNhcmRDbGljaywgaGFuZGxlQ29uZmlybUNsaWNrLCBoYW5kbGVDYXJkTGlrZSwgdXNlcklkKSB7XG4gICAgICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgICAgIHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IgPSB0ZW1wbGF0ZVNlbGVjdG9yO1xuICAgICAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XG4gICAgICAgIHRoaXMuX293bmVySWQgPSBkYXRhLm93bmVyLl9pZDtcbiAgICAgICAgdGhpcy5fY2FyZElkID0gZGF0YS5faWQ7XG4gICAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICAgICAgdGhpcy5faGFuZGxlQ29uZmlybUNsaWNrID0gaGFuZGxlQ29uZmlybUNsaWNrO1xuXG4gICAgICAgIHRoaXMuX2hhbmRsZUNhcmRMaWtlID0gaGFuZGxlQ2FyZExpa2U7XG4gICAgICAgIHRoaXMuX2lzTGlrZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XG4gICAgfVxuXG4gICAgX2dldFRlbXBsYXRlID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAgICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yKVxuICAgICAgICAgICAgLmNvbnRlbnRcbiAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudCcpXG4gICAgICAgICAgICAuY2xvbmVOb2RlKHRydWUpXG4gICAgICAgIHJldHVybiBjYXJkRWxlbWVudDtcbiAgICB9XG5cblxuICAgICAgLy/QoNCw0LHQvtGC0LAg0LrQvdC+0L/QutC4IFwi0LvQsNC50LpcIlxuICAgICAgX2NsaWNrTGlrZUJ1dHRvbigpIHtcbiAgICAgICAgdGhpcy5fYnV0dG9uTGlrZUNhcmQuY2xhc3NMaXN0LnRvZ2dsZSgnZWxlbWVudF9faWNvbl9hY3RpdmUnKVxuICAgIH1cblxuICAgIGdldCBpc0xpa2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pc0xpa2U7XG4gICAgfVxuXG4gICAgLy/QvNC10YLQvtC0INC/0L7Qu9GD0YfQtdC90LjRjyDQu9Cw0LnQutC+0LIgXG4gICAgc2V0TGlrZXMobGlrZXMpIHtcbiAgICAgICAgdGhpcy5fbGlrZXMgPSBsaWtlczsgLy/QsiDQv9C10YDQtdC80LXQvdC90YPRjiDQv9C+0LvRg9GH0LDQtdC8INC90L7QstC+0LUg0LrQvtC7LdCy0L4g0LvQsNC50LrQvtCyXG4gICAgICAgIHRoaXMuX2NvdW50ZXJMaWtlcy50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDs7IC8v0LfQsNC/0LjRgdGL0LLQsNC10Lwg0Y3RgtC+INC60L7Quy3QstC+INCyINGP0YfQtdC50LrRg1xuICAgIH1cblxuICAgIC8v0LzQtdGC0L7QtCDQv9C10YDQtdC60LvRjtGH0LXQvdC40Y8g0LrQvdC+0L/QutC4XG4gICAgdG9nZ2xlTGlrZSgpIHtcbiAgICAgICAgdGhpcy5fYnV0dG9uTGlrZUNhcmQuY2xhc3NMaXN0LnRvZ2dsZSgnZWxlbWVudF9faWNvbl9hY3RpdmUnKTtcbiAgICB9XG5cbiAgICAvL9C80LXRgtC+0LQg0LTQu9GPINC/0LXRgNC10LrQu9GO0YfQtdC90LjRjyDQsdGD0LvQtdCy0YvRhSDQt9C90LDRh9C10L3QuNC5XG4gICAgdG9nZ2xlSXNMaWtlKCl7XG4gICAgICAgIHRoaXMuX2lzTGlrZSA9ICF0aGlzLl9pc0xpa2U7XG4gICAgfVxuXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xuXG4gICAgICAgdGhpcy5fYnV0dG9uTGlrZUNhcmQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19pY29uJyk7XG5cbiAgICAgICAgdGhpcy5fZWxlbWVudFxuICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19pY29uLXRyYXNoJylcbiAgICAgICAgICAgIC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLl9oYW5kbGVDb25maXJtQ2xpY2sodGhpcy5fY2FyZElkLCB0aGlzLl9lbGVtZW50KVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5fYnV0dG9uTGlrZUNhcmQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5faGFuZGxlQ2FyZExpa2UodGhpcy5fY2FyZElkLCB0aGlzKTtcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgdGhpcy5fZWxlbWVudFxuICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19waG90bycpXG4gICAgICAgICAgICAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZ2V0Q2FyZFBvcHVwSW1nKCk7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBkZWxldGUoKSB7XG4gICAgICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xuICAgIH1cblxuICAgIF9nZXRDYXJkUG9wdXBJbWcgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKVxuICAgIH1cblxuICAgIGdlbmVyYXRlQ2FyZCA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgICAgIHRoaXMuX2VsZW1lbnRQaG90byA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX3Bob3RvJyk7XG4gICAgICAgIHRoaXMuX2VsZW1lbnRQaG90by5zcmMgPSB0aGlzLl9saW5rO1xuICAgICAgICB0aGlzLl9lbGVtZW50UGhvdG8uYWx0ID0gdGhpcy5fbmFtZTtcbiAgICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fdGl0bGUnKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gICAgICAgIHRoaXMuX2J1dHRvbkRlbGV0ZUNhcmQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19pY29uLXRyYXNoJyk7XG4gICAgICAgIHRoaXMuX2J1dHRvbkxpa2VDYXJkID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9faWNvbicpO1xuICAgICAgICB0aGlzLl9jb3VudGVyTGlrZXMgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19udW1iZXJzJyk7XG4gICAgICAgIHRoaXMuX2NvdW50ZXJMaWtlcy50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcblxuICAgICAgICBpZiAodGhpcy5fdXNlcklkICE9PSB0aGlzLl9vd25lcklkKSB7XG4gICAgICAgICAgICB0aGlzLl9idXR0b25EZWxldGVDYXJkLnJlbW92ZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgIC8v0JTQvtCx0LDQstC70Y/QtdC8INC/0YDQvtCy0LXRgNC60YMg0LXRgdGC0Ywg0LvQuCDRgyDQutCw0YDRgtC+0YfQutC4INC70LDQudC6INC40LvQuCDQvdC10YJcbiAgICAgICAgIGlmICh0aGlzLl9saWtlcy5maW5kKGl0ZW0gPT4gaXRlbS5faWQgPT09IHRoaXMuX3VzZXJJZCkpIHtcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkxpa2VDYXJkLmNsYXNzTGlzdC5hZGQoJ2VsZW1lbnRfX2ljb25fYWN0aXZlJyk7XG4gICAgICAgICAgICB0aGlzLl9pc0xpa2UgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gICAgfVxufVxuIiwiLy8g0LLQsNC70LjQtNCw0YbQuNGPXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm1FbGVtZW50KSB7XG4gICAgICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZztcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKSk7XG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gICAgfVxuXG4gICAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWlucHV0LWVycm9yYCk7XG4gICAgICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5lcnJvckNsYXNzKTtcbiAgICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gJyc7XG4gICAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuICAgIH1cblxuICAgIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1pbnB1dC1lcnJvcmApO1xuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuZXJyb3JDbGFzcyk7XG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG4gICAgfVxuXG4gICAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICAgICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+ICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSk7XG4gICAgfVxuXG4gICAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgICAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIH1cblxuICAgIHNldEJ1dHRvblN0YXRlKCkge1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIH1cblxuICAgIGNsZWFySW5wdXRFcnJvcigpIHtcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goaW5wdXRFbGVtZW50ID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICAgIH0pO1xuICAgIH1cbn1cbiIsIlxuZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25Db25maWcgPSB7XG4gICAgZm9ybVNlbGVjdG9yOiAnLnBvcHVwX19mb3JtJywgLy8g0YHQtdC70LXQutGC0L7RgCDRhNC+0YDQvNGLXG4gICAgaW5wdXRTZWxlY3RvcjogJy5wb3B1cF9faW5wdXQnLCAvLyDRgdC10LvQtdC60YLQvtGAIGlucHV0XG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6ICcucG9wdXBfX2J1dHRvbicsLy8g0YHQtdC70LXQutGC0L7RgCDQutC90L7Qv9C60Lggc3VibWl0XG4gICAgaW5hY3RpdmVCdXR0b25DbGFzczogJ3BvcHVwX19idXR0b25fZGlzYWJsZWQnLC8vINGB0L7RgdGC0L7Rj9C90LjQtSDQutC90L7Qv9C60Lggc3VibWl0XG4gICAgaW5wdXRFcnJvckNsYXNzOiAncG9wdXBfX2lucHV0X3R5cGVfZXJyb3InLCAvLyDQv9C+0LTRh9C10YDQutC40LLQsNC90LjQtSDQutGA0LDRgdC90YvQvCBpbnB1dFxuICAgIGVycm9yQ2xhc3M6ICdwb3B1cF9fZXJyb3JfdmlzaWJsZSdcbn07IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gICAgY29uc3RydWN0b3Ioe3JlbmRlcmVyfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICAgICAgdGhpcy5fY29udGFpbmVyID1cbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpOyAvLyDQutGD0LTQsCDQtNC+0LHQsNCy0LvRj9C10LwgXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7IC8v0YTRg9C90LrQuNGG0Y8g0L7RgtGA0LjRgdC+0LLQutC4INC4INGB0L7Qt9C00LDQvdC40Y9cbiAgICB9XG5cbiAgICByZW5kZXJJdGVtcyhpdGVtcykge1xuICAgICAgICBpdGVtcy5yZXZlcnNlKCkuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICB9XG5cbiAgICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gICAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICAgICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gICAgfVxuXG4gICAgb3BlbigpIHtcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZCgncG9wdXBfYWN0aXZlJyk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB9XG5cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXBfYWN0aXZlJyk7XG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB9XG5cbiAgICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XG4gICAgICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XG4gICAgICAgICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwX2FjdGl2ZScpIHx8IGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9fY2xvc2UnKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgXG4gICAgfVxufSIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJ1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGZvcm1TdWJtaXQpIHtcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX2Zvcm1TdWJtaXQgPSBmb3JtU3VibWl0OyAvL9C60L7Qu9Cx0LXQuiDRgdCw0LzQsdC40YLQsCDRhNC+0YDQvNGLXG4gICAgICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcbiAgICAgICAgdGhpcy5faW5wdXRzID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2lucHV0Jyk7XG4gICAgICAgIHRoaXMuX2J1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYnV0dG9uJyk7XG4gICAgfVxuXG4gICAgY2hhbmdlVGV4dCh0ZXh0KSB7XG4gICAgdGhpcy5fYnV0dG9uLnRleHRDb250ZW50ID0gdGV4dDtcbiAgIH1cblxuICAgIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICAgICAgIHRoaXMuX2lucHV0c1ZhbHVlcyA9IHt9O1xuICAgICAgICB0aGlzLl9pbnB1dHMuZm9yRWFjaCgoaW5wdXRzKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9pbnB1dHNWYWx1ZXNbaW5wdXRzLm5hbWVdID0gaW5wdXRzLnZhbHVlO1xuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gdGhpcy5faW5wdXRzVmFsdWVzO1xuICAgIH1cblxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgICAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5fZm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICAgICAgfSkgXG4gICAgfVxuXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcbiAgICB9XG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlJyk7XG4gICAgICAgIHRoaXMuX3BvcHVwVGl0bGUgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3RpdGxlLWltZycpO1xuICAgIH1cblxuICAgIG9wZW4obGluaywgbmFtZSkge1xuICAgICAgICB0aGlzLl9wb3B1cEltYWdlLnNyYyA9IGxpbms7XG4gICAgICAgIHRoaXMuX3BvcHVwSW1hZ2UuYWx0ID0gbmFtZTtcbiAgICAgICAgdGhpcy5fcG9wdXBUaXRsZS50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgICAgIFxuICAgICAgICBzdXBlci5vcGVuKCk7XG4gICAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgICBjb25zdHJ1Y3RvciAoe25hbWUsIGFib3V0LCBhdmF0YXIsIF91c2VySWR9KSB7XG4gICAgICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWUpO1xuICAgICAgICB0aGlzLl9hYm91dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYWJvdXQpO1xuICAgICAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhcik7XG4gICAgICAgIHRoaXMuX3VzZXJJZCA9IF91c2VySWQ7XG4gICAgfVxuXG4gICAgZ2V0VXNlckluZm8gPSAoKSA9PiB7IC8vINCy0L7Qt9Cy0YDQsNGJ0LDQtdC8INC+0LHRitC10LrRgiDRgSDQtNCw0L3QvdGL0LzQuCDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y9cbiAgICAgICByZXR1cm4ge1xuICAgICAgICBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxuICAgICAgICBhYm91dDogdGhpcy5fYWJvdXQudGV4dENvbnRlbnQsXG4gICAgICAgIGF2YXRhcjogdGhpcy5fYXZhdGFyLnNyYyxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBzZXRVc2VySW5mbyA9ICh1c2VyRGF0YSkgPT4geyAvLyDQv9GA0LjQvdC40LzQsNC10Lwg0L3QvtCy0YvQtSDQtNCw0L3QvdGL0LUg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPXG4gICAgICAgIGNvbnN0IHtuYW1lLCBhYm91dCwgYXZhdGFyLCBfdXNlcklkfSA9IHVzZXJEYXRhO1xuICAgICAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICAgICAgdGhpcy5fYWJvdXQudGV4dENvbnRlbnQgPSBhYm91dDtcbiAgICAgICAgdGhpcy5fYXZhdGFyLnNyYyA9IGF2YXRhcjtcbiAgICAgICAgdGhpcy5fYXZhdGFyLmFsdCA9IG5hbWU7XG4gICAgICAgIHRoaXMuX3VzZXJJZCA9IF91c2VySWQ7XG4gICAgfVxuXG4gICAgZ2V0VXNlcklkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdXNlcklkO1xuICAgIH1cbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSAnLi9Qb3B1cC5qcydcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBDb25maXJtRGVsZXRlIGV4dGVuZHMgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUNvbmZpcm1DbGljaykge1xuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5faGFuZGxlQ29uZmlybUNsaWNrID0gaGFuZGxlQ29uZmlybUNsaWNrLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuX2J1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYnV0dG9uJylcbiAgICAgICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xuICAgIH1cblxuICAgIGNoYW5nZVRleHQodGV4dCkge1xuICAgICAgICB0aGlzLl9idXR0b24udGV4dENvbnRlbnQgPSB0ZXh0O1xuICAgIH1cbiAgICBcbiAgICBvcGVuKGNhcmRJZCwgY2FyZEl0ZW0pIHtcbiAgICAgICAgc3VwZXIub3BlbigpO1xuXG4gICAgICAgIHRoaXMuX2NhcmRJZCA9IGNhcmRJZDtcbiAgICAgICAgdGhpcy5fY2FyZEl0ZW0gPSBjYXJkSXRlbTtcbiAgICB9XG5cbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICAgICB0aGlzLl9mb3JtXG4gICAgICAgIC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7XG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUNvbmZpcm1DbGljayh0aGlzLl9jYXJkSWQsIHRoaXMuX2NhcmRJdGVtLCB0aGlzLl9idXR0b24pXG4gICAgICAgIH0pXG4gICAgfVxufSIsImV4cG9ydCBjb25zdCBwb3B1cFBob3RvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3Bob3RvJyk7XG5leHBvcnQgY29uc3QgcG9wdXBUaXRsZVBob3RvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbWFnZScpO1xuZXhwb3J0IGNvbnN0IHBvcHVwTGlua1Bob3RvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX190aXRsZS1pbWcnKTtcbmV4cG9ydCBjb25zdCBwb3B1cFByb2ZpbGVPcGVuQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQnKTtcbmV4cG9ydCBjb25zdCBwb3B1cEVkaXRQcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX2VkaXQtY2FyZCcpO1xuZXhwb3J0IGNvbnN0IGJ1dHRvbkFib3V0VXNlciA9IHBvcHVwRWRpdFByb2ZpbGUucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24nKVxuZXhwb3J0IGNvbnN0IGZvcm1FZGl0UHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xuZXhwb3J0IGNvbnN0IGZvcm1BZGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2FkZC1mb3JtJyk7XG5leHBvcnQgY29uc3QgaW5wdXRBZGRUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV90aXRsZScpO1xuZXhwb3J0IGNvbnN0IGlucHV0QWRkTGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV9saW5rJyk7XG5leHBvcnQgY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX25hbWUnKTtcbmV4cG9ydCBjb25zdCBhYm91dElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX2Fib3V0Jyk7XG5leHBvcnQgY29uc3QgbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX190aXRsZScpO1xuZXhwb3J0IGNvbnN0IGFib3V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX3N1YnRpdGxlJyk7XG5leHBvcnQgY29uc3QgZWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudHMnKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlQWRkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZCcpO1xuZXhwb3J0IGNvbnN0IHBvcHVwQWRkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX2FkZC1jYXJkJyk7XG5leHBvcnQgY29uc3QgYnV0dG9uc0Nsb3NlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19jbG9zZScpO1xuZXhwb3J0IGxldCB1c2VySWQgXG5leHBvcnQgY29uc3QgcG9wdXBCdXR0b25BdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9faWNvbi1lZGl0Jyk7XG5leHBvcnQgY29uc3QgZm9ybUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYXZhdGFyLWZvcm0nKTtcbmV4cG9ydCBjb25zdCBpbnB1dEF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV9hdmF0YXInKVxuZXhwb3J0IGNvbnN0IHVzZXJzRGF0YUVkaXQgPSB7XG4gICAgbmFtZTogJy5wcm9maWxlX190aXRsZScsXG4gICAgYWJvdXQ6ICcucHJvZmlsZV9fc3VidGl0bGUnLFxuICAgIGF2YXRhcjogJy5wcm9maWxlX19hdmF0YXInLFxufTtcblxuZXhwb3J0IGNvbnN0IHBvcHVwU2VsZWN0b3JzID0ge1xuICAgIHBvcHVwQWRkQ2FyZDogJy5wb3B1cF9hZGQtY2FyZCcsXG4gICAgcG9wdXBFZGl0UHJvZmlsZTogJy5wb3B1cF9lZGl0LWNhcmQnLFxuICAgIHBvcHVwV2l0aEltZzogJy5wb3B1cF9waG90bycsXG4gICAgcG9wdXBDb25maXJtRGVsZXRlOiAnLnBvcHVwX2RlbGV0ZS1jYXJkJyxcbiAgICBwb3B1cEF2YXRhcjogJy5wb3B1cF9hdmF0YXInXG59XG5cbmV4cG9ydCBjb25zdCBvcHRpb25zID0ge1xuICAgIHVybDogJ2h0dHBzOi8vbWVzdG8ubm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtNjAnLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogJ2UyNGRkNDlhLTQxMDEtNDU1Yi05ZmI1LTMxMTAzOGRmZDcwNycsXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICB9XG59XG5cblxuXG5cblxuIiwiXG5pbXBvcnQgQ2FyZCBmcm9tICcuLi9jb21wb25lbnRzL0NhcmQuanMnO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSAnLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzJztcbmltcG9ydCB7IHZhbGlkYXRpb25Db25maWcgfSBmcm9tICcuLi9jb25zdGFudHMvY29uc3RhbnRzLmpzJztcbmltcG9ydCAnLi9pbmRleC5jc3MnO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSAnLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzJztcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyc7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyc7XG5pbXBvcnQgVXNlckluZm8gZnJvbSAnLi4vY29tcG9uZW50cy9Vc2VySW5mby5qcydcbmltcG9ydCBQb3B1cENvbmZpcm1EZWxldGUgZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cENvbmZpcm1EZWxldGUuanMnXG5cbmltcG9ydCB7XG4gICAgIHBvcHVwUHJvZmlsZU9wZW5CdXR0b24sXG4gICAgIGZvcm1FZGl0UHJvZmlsZSwgZm9ybUFkZCxcbiAgICBuYW1lSW5wdXQsIGFib3V0SW5wdXQsICBwcm9maWxlQWRkLCBcbiAgICB1c2Vyc0RhdGFFZGl0LCBwb3B1cFNlbGVjdG9ycywgb3B0aW9ucyxcbiAgICAgIHBvcHVwQnV0dG9uQXZhdGFyLCBmb3JtQXZhdGFyXG59IGZyb20gJy4uL3V0aWxzL3V0aWxzLmpzJztcbmltcG9ydCBBcGkgZnJvbSAnLi4vY29tcG9uZW50cy9BcGkuanMnO1xuXG5sZXQgdXNlcklkO1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKG9wdGlvbnMpO1xuXG5Qcm9taXNlLmFsbChbYXBpLmdldEluaXRpYWxDYXJkcygpLCBhcGkuZ2V0VXNlckluZm8oKV0pXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBjb25zdCBJbml0aWFsQ2FyZHMgPSByZXNbMF07XG4gICAgICAgIGNvbnN0IFVzZXJJbmZvID0gcmVzWzFdO1xuXG4gICAgICAgIGNhcmRMaXN0LnJlbmRlckl0ZW1zKEluaXRpYWxDYXJkcyk7XG5cbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oVXNlckluZm8pO1xuICAgICAgICB1c2VySW5mby5nZXRVc2VySWQoVXNlckluZm8uX2lkKVxuICAgICAgICB1c2VySWQgPSBVc2VySW5mby5faWRcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgfSlcblxuY29uc3QgY3JlYXRlQ2FyZCA9IChpdGVtKSA9PiB7XG4gICAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKGl0ZW0sICcjZWxlbWVudC10ZW1wbGF0ZScsXG4gICAgICAgICgpID0+IHsgcG9wdXBJbWFnZS5vcGVuKGl0ZW0ubGluaywgaXRlbS5uYW1lKSB9LFxuICAgICAgICBoYW5kbGVDb25maXJtQ2xpY2ssXG4gICAgICAgIChjYXJkSWQpID0+IHtcbiAgICAgICAgICAgIGlmIChjYXJkLmlzTGlrZSkge1xuICAgICAgICAgICAgICAgIGFwaS5kZWxldGVMaWtlcyhjYXJkSWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgICAgICAgY2FyZC5zZXRMaWtlcyhyZXMubGlrZXMpO1xuICAgICAgICAgICAgICAgICAgY2FyZC50b2dnbGVJc0xpa2UoKTtcbiAgICAgICAgICAgICAgICAgIGNhcmQudG9nZ2xlTGlrZSgpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBhcGkuc2V0TGlrZXMoY2FyZElkKVxuICAgICAgICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgIGNhcmQuc2V0TGlrZXMocmVzLmxpa2VzKTtcbiAgICAgICAgICAgICAgICAgICAgICBjYXJkLnRvZ2dsZUlzTGlrZSgpO1xuICAgICAgICAgICAgICAgICAgICAgIGNhcmQudG9nZ2xlTGlrZSgpO1xuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLHVzZXJJZClcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuZ2VuZXJhdGVDYXJkKCk7XG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xufVxuXG5cbmZ1bmN0aW9uIGhhbmRsZUNvbmZpcm1DbGljayhjYXJkSWQsIGNhcmRJdGVtKSB7XG4gICAgcG9wdXBDb25maXJtRGVsZXRlQ2FyZC5vcGVuKGNhcmRJZCwgY2FyZEl0ZW0pXG59XG5cbmNvbnN0IGNhcmRMaXN0ID0gbmV3IFNlY3Rpb24oXG4gICAge1xuICAgICAgICByZW5kZXJlcjogKGl0ZW0pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNhcmQgPSBjcmVhdGVDYXJkKGl0ZW0pO1xuICAgICAgICAgICAgY2FyZExpc3QuYWRkSXRlbShjYXJkKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAsICcuZWxlbWVudHMnKVxuXG4vLyDQvtGC0L7QsdGA0LDQttC10L3QuNC1INC40L3RhNC+0YDQvNCw0YbQuNC4INC+INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvQuCBcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHVzZXJzRGF0YUVkaXQpO1xuXG5cbmNvbnN0IHBvcHVwQWJvdXRVc2VycyA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICAgIHBvcHVwU2VsZWN0b3JzLnBvcHVwRWRpdFByb2ZpbGUsXG4gICAgKHVzZXJEYXRhKSA9PiB7XG4gICAgICAgIHBvcHVwQWJvdXRVc2Vycy5jaGFuZ2VUZXh0KCfQodC+0YXRgNCw0L3QtdC90LjQtS4uLicpXG4gICAgICAgIGFwaS5zZXRJbmZvVXNlcih1c2VyRGF0YSlcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICBwb3B1cEFib3V0VXNlcnMuY2xvc2UoKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICAgICAgICBwb3B1cEFib3V0VXNlcnMuY2hhbmdlVGV4dCgn0KHQvtGF0YDQsNC90LjRgtGMJyk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9KVxuICAgIH0sXG4pO1xuXG5jb25zdCBwb3B1cEFkZENhcmQgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgICBwb3B1cFNlbGVjdG9ycy5wb3B1cEFkZENhcmQsXG4gICAgKGl0ZW0pID0+IHtcbiAgICAgICAgcG9wdXBBZGRDYXJkLmNoYW5nZVRleHQoJ9Ch0L7RhdGA0LDQvdC10L3QuNC1Li4uJylcbiAgICAgICAgYXBpLmNyZWF0ZU5ld0NhcmQoaXRlbSlcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChyZXMpO1xuICAgICAgICAgICAgICAgIGNhcmRMaXN0LmFkZEl0ZW0oY2FyZCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIHBvcHVwQWRkQ2FyZC5jbG9zZSgpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHBvcHVwQWRkQ2FyZC5jaGFuZ2VUZXh0KCfQodC+0YXRgNCw0L3QuNGC0YwnKVxuICAgICAgICAgICAgfSlcbiAgICB9KTtcblxuY29uc3QgcG9wdXBDb25maXJtRGVsZXRlQ2FyZCA9IG5ldyBQb3B1cENvbmZpcm1EZWxldGUoXG4gICAgcG9wdXBTZWxlY3RvcnMucG9wdXBDb25maXJtRGVsZXRlLFxuICAgIChjYXJkSWQsIGNhcmRJdGVtLCkgPT4ge1xuICAgICAgICBwb3B1cENvbmZpcm1EZWxldGVDYXJkLmNoYW5nZVRleHQoJ9Cj0LTQsNC70LXQvdC40LUuLi4nKVxuICAgICAgICBhcGkuZGVsZXRlQ2FyZChjYXJkSWQpXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgY2FyZEl0ZW0ucmVtb3ZlKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIHBvcHVwQ29uZmlybURlbGV0ZUNhcmQuY2xvc2UoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHBvcHVwQ29uZmlybURlbGV0ZUNhcmQuY2hhbmdlVGV4dCgn0JTQsCcpXG4gICAgICAgICAgICB9KVxuXG4gICAgfVxuKVxuXG5jb25zdCBwb3B1cEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKHBvcHVwU2VsZWN0b3JzLnBvcHVwV2l0aEltZyk7XG5cbi8v0LDQstCw0YLQsNGAINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRj1xuY29uc3QgcG9wdXBVc2VyQXZhdGFyID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gICAgcG9wdXBTZWxlY3RvcnMucG9wdXBBdmF0YXIsXG4gICAgKG5ld0F2YXRhckxpbmspID0+IHtcbiAgICAgICAgcG9wdXBVc2VyQXZhdGFyLmNoYW5nZVRleHQoJ9Ch0L7RhdGA0LDQvdC10L3QuNC1Li4uJylcbiAgICAgICAgYXBpLnNldFVzZXJBdmF0YXIobmV3QXZhdGFyTGluay5saW5rKVxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHJlcylcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgcG9wdXBVc2VyQXZhdGFyLmNsb3NlKClcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHBvcHVwVXNlckF2YXRhci5jaGFuZ2VUZXh0KCfQodC+0YXRgNCw0L3QuNGC0YwnKVxuICAgICAgICAgICAgfSlcbiAgICB9XG4pXG5cbi8v0L/QvtC/0LDQvyDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNGPINC/0YDQvtGE0LjQu9GPXG5wb3B1cFByb2ZpbGVPcGVuQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxcbiAgICAoZXZ0KSA9PiB7XG4gICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBjb25zdCB7IG5hbWUsIGFib3V0IH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICAgICAgICBuYW1lSW5wdXQudmFsdWUgPSBuYW1lO1xuICAgICAgICBhYm91dElucHV0LnZhbHVlID0gYWJvdXQ7XG4gICAgICAgIHBvcHVwQWJvdXRVc2Vycy5vcGVuKCk7XG4gICAgICAgIGZvcm1WYWxpZEVkaXQuY2xlYXJJbnB1dEVycm9yKCk7XG4gICAgfSk7XG4vL9C/0L7Qv9Cw0L8g0LTQvtCx0LDQstC70LXQvdC40Y8g0LrQsNGA0YLQvtGH0LrQuFxucHJvZmlsZUFkZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsXG4gICAgKCkgPT4ge1xuICAgICAgICBwb3B1cEFkZENhcmQub3BlbigpO1xuICAgICAgICBmb3JtVmFsaWRBZGQuc2V0QnV0dG9uU3RhdGUoKTtcbiAgICB9KTtcblxucG9wdXBCdXR0b25BdmF0YXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLFxuICAgICgpID0+IHtcbiAgICAgICAgcG9wdXBVc2VyQXZhdGFyLm9wZW4oKVxuICAgICAgICBmb3JtVmFsaWRBdmF0YXIuc2V0QnV0dG9uU3RhdGUoKVxuICAgIH1cbilcblxucG9wdXBBYm91dFVzZXJzLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5wb3B1cEFkZENhcmQuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbnBvcHVwSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbnBvcHVwQ29uZmlybURlbGV0ZUNhcmQuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbnBvcHVwVXNlckF2YXRhci5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vL9Cy0LDQu9C40LTQsNGG0LjRjyDRhNC+0YDQvNGLXG5jb25zdCBmb3JtVmFsaWRBZGQgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uQ29uZmlnLCBmb3JtQWRkKTtcbmNvbnN0IGZvcm1WYWxpZEVkaXQgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uQ29uZmlnLCBmb3JtRWRpdFByb2ZpbGUpO1xuY29uc3QgZm9ybVZhbGlkQXZhdGFyID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvbkNvbmZpZywgZm9ybUF2YXRhcik7XG5mb3JtVmFsaWRBZGQuZW5hYmxlVmFsaWRhdGlvbigpO1xuZm9ybVZhbGlkRWRpdC5lbmFibGVWYWxpZGF0aW9uKCk7XG5mb3JtVmFsaWRBdmF0YXIuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgICAgIHRoaXMuX3VybCA9IG9wdGlvbnMudXJsO1xuICAgICAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xuICAgIH1cblxuICAgIF9jaGVja1N0YXR1c1JlcyhyZXMpIHtcbiAgICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKVxuICAgIH1cblxuICAgIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHNgLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbihyZXMgPT4gdGhpcy5fY2hlY2tTdGF0dXNSZXMocmVzKSlcbiAgICB9XG5cbiAgICBnZXRVc2VySW5mbygpIHtcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWVgLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHJlcyA9PiB0aGlzLl9jaGVja1N0YXR1c1JlcyhyZXMpKVxuICAgIH1cblxuICAgIHNldEluZm9Vc2VyKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS91c2Vycy9tZWAsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICBtZXRob2Q6ICdQQVRDSCcsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgICAgICBhYm91dDogYWJvdXQsXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgICAgICAudGhlbihyZXMgPT4gdGhpcy5fY2hlY2tTdGF0dXNSZXMocmVzKSlcbiAgICB9XG5cbiAgICBjcmVhdGVOZXdDYXJkKGl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHNgLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgbmFtZTogaXRlbS5uYW1lLFxuICAgICAgICAgICAgICAgIGxpbms6IGl0ZW0ubGluayxcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHJlcyA9PiB0aGlzLl9jaGVja1N0YXR1c1JlcyhyZXMpKVxuICAgIH1cblxuICAgIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzLyR7Y2FyZElkfWAse1xuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHJlcyA9PiB0aGlzLl9jaGVja1N0YXR1c1JlcyhyZXMpKVxuICAgIH1cblxuICAgIHNldExpa2VzKGNhcmRJZCkge1xuICAgICAgICByZXR1cm4gZmV0Y2ggKGAke3RoaXMuX3VybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgIG1ldGhvZDogJ1BVVCdcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4ocmVzID0+IHRoaXMuX2NoZWNrU3RhdHVzUmVzKHJlcykpXG4gICAgfVxuXG4gICAgZGVsZXRlTGlrZXMoY2FyZElkKSB7XG4gICAgICAgIHJldHVybiBmZXRjaCAoYCR7dGhpcy5fdXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJ1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihyZXMgPT4gdGhpcy5fY2hlY2tTdGF0dXNSZXMocmVzKSlcbiAgICB9IFxuXG4gICAgc2V0VXNlckF2YXRhcihuZXdBdmF0YXJMaW5rKSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICBtZXRob2Q6ICdQQVRDSCcsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgYXZhdGFyOiBuZXdBdmF0YXJMaW5rLCBcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHJlcyA9PiB0aGlzLl9jaGVja1N0YXR1c1JlcyhyZXMpKVxuICAgIH1cbn0iXSwibmFtZXMiOlsiQ2FyZCIsImRhdGEiLCJ0ZW1wbGF0ZVNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlQ29uZmlybUNsaWNrIiwiaGFuZGxlQ2FyZExpa2UiLCJ1c2VySWQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJfdGVtcGxhdGVTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfYnV0dG9uTGlrZUNhcmQiLCJfZWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlQ29uZmlybUNsaWNrIiwiX2NhcmRJZCIsIl9oYW5kbGVDYXJkTGlrZSIsIl9nZXRDYXJkUG9wdXBJbWciLCJfaGFuZGxlQ2FyZENsaWNrIiwiX25hbWUiLCJfbGluayIsIl9nZXRUZW1wbGF0ZSIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9lbGVtZW50UGhvdG8iLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsIl9idXR0b25EZWxldGVDYXJkIiwiX2NvdW50ZXJMaWtlcyIsIl9saWtlcyIsImxlbmd0aCIsIl91c2VySWQiLCJfb3duZXJJZCIsInJlbW92ZSIsImZpbmQiLCJpdGVtIiwiX2lkIiwiY2xhc3NMaXN0IiwiYWRkIiwiX2lzTGlrZSIsInRoaXMiLCJuYW1lIiwibGluayIsIm93bmVyIiwibGlrZXMiLCJ0b2dnbGUiLCJGb3JtVmFsaWRhdG9yIiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJfY29uZmlnIiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiX2J1dHRvbkVsZW1lbnQiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImlucHV0RWxlbWVudCIsImVycm9yRWxlbWVudCIsImlkIiwiZXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsInZhbGlkYXRpb25NZXNzYWdlIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsInNvbWUiLCJfaGFzSW52YWxpZElucHV0IiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImRpc2FibGVkIiwiZm9yRWFjaCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJ2YWxpZGF0aW9uQ29uZmlnIiwiZm9ybVNlbGVjdG9yIiwiU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwicmVuZGVyZXIiLCJfY29udGFpbmVyIiwiX3JlbmRlcmVyIiwiaXRlbXMiLCJyZXZlcnNlIiwiZWxlbWVudCIsInByZXBlbmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsImtleSIsImNsb3NlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiZm9ybVN1Ym1pdCIsIl9mb3JtU3VibWl0IiwiX2Zvcm0iLCJfaW5wdXRzIiwiX2J1dHRvbiIsInRleHQiLCJfaW5wdXRzVmFsdWVzIiwiaW5wdXRzIiwidmFsdWUiLCJwcmV2ZW50RGVmYXVsdCIsIl9nZXRJbnB1dFZhbHVlcyIsInJlc2V0IiwiUG9wdXBXaXRoSW1hZ2UiLCJfcG9wdXBJbWFnZSIsIl9wb3B1cFRpdGxlIiwiVXNlckluZm8iLCJhYm91dCIsImF2YXRhciIsIl9hYm91dCIsIl9hdmF0YXIiLCJ1c2VyRGF0YSIsIlBvcHVwQ29uZmlybURlbGV0ZSIsImNhcmRJZCIsImNhcmRJdGVtIiwiX2NhcmRJdGVtIiwicG9wdXBQcm9maWxlT3BlbkJ1dHRvbiIsImZvcm1FZGl0UHJvZmlsZSIsImZvcm1BZGQiLCJuYW1lSW5wdXQiLCJhYm91dElucHV0IiwicHJvZmlsZUFkZCIsInBvcHVwQnV0dG9uQXZhdGFyIiwiZm9ybUF2YXRhciIsInBvcHVwU2VsZWN0b3JzIiwiYXBpIiwib3B0aW9ucyIsIl91cmwiLCJ1cmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZmV0Y2giLCJ0aGVuIiwiX2NoZWNrU3RhdHVzUmVzIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJuZXdBdmF0YXJMaW5rIiwiYXV0aG9yaXphdGlvbiIsImFsbCIsImdldEluaXRpYWxDYXJkcyIsImdldFVzZXJJbmZvIiwiSW5pdGlhbENhcmRzIiwiY2FyZExpc3QiLCJyZW5kZXJJdGVtcyIsInVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJnZXRVc2VySWQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJjcmVhdGVDYXJkIiwiY2FyZCIsInBvcHVwSW1hZ2UiLCJvcGVuIiwiaXNMaWtlIiwiZGVsZXRlTGlrZXMiLCJzZXRMaWtlcyIsInRvZ2dsZUlzTGlrZSIsInRvZ2dsZUxpa2UiLCJnZW5lcmF0ZUNhcmQiLCJwb3B1cENvbmZpcm1EZWxldGVDYXJkIiwiYWRkSXRlbSIsInBvcHVwQWJvdXRVc2VycyIsImNoYW5nZVRleHQiLCJzZXRJbmZvVXNlciIsImZpbmFsbHkiLCJwb3B1cEFkZENhcmQiLCJjcmVhdGVOZXdDYXJkIiwiZGVsZXRlQ2FyZCIsInBvcHVwVXNlckF2YXRhciIsInNldFVzZXJBdmF0YXIiLCJmb3JtVmFsaWRFZGl0IiwiY2xlYXJJbnB1dEVycm9yIiwiZm9ybVZhbGlkQWRkIiwic2V0QnV0dG9uU3RhdGUiLCJmb3JtVmFsaWRBdmF0YXIiLCJzZXRFdmVudExpc3RlbmVycyIsImVuYWJsZVZhbGlkYXRpb24iXSwic291cmNlUm9vdCI6IiJ9